# é£Ÿå“å®‰å…¨æ ‡ç­¾æ£€æµ‹æ£€æµ‹ç³»ç»Ÿæºç åˆ†äº«
 # [ä¸€æ¡é¾™æ•™å­¦YOLOV8æ ‡æ³¨å¥½çš„æ•°æ®é›†ä¸€é”®è®­ç»ƒ_70+å…¨å¥—æ”¹è¿›åˆ›æ–°ç‚¹å‘åˆŠ_Webå‰ç«¯å±•ç¤º]

### 1.ç ”ç©¶èƒŒæ™¯ä¸Žæ„ä¹‰

é¡¹ç›®å‚è€ƒ[AAAI Association for the Advancement of Artificial Intelligence](https://gitee.com/qunshansj/projects)

é¡¹ç›®æ¥æº[AACV Association for the Advancement of Computer Vision](https://gitee.com/qunmasj/projects)

ç ”ç©¶èƒŒæ™¯ä¸Žæ„ä¹‰

éšç€å…¨çƒé£Ÿå“äº§ä¸šçš„å¿«é€Ÿå‘å±•ï¼Œé£Ÿå“å®‰å…¨é—®é¢˜æ—¥ç›Šå—åˆ°ç¤¾ä¼šå„ç•Œçš„å¹¿æ³›å…³æ³¨ã€‚é£Ÿå“å®‰å…¨ä¸ä»…å…³ç³»åˆ°æ¶ˆè´¹è€…çš„å¥åº·å’Œç”Ÿå‘½å®‰å…¨ï¼Œä¹Ÿç›´æŽ¥å½±å“åˆ°å›½å®¶çš„ç»æµŽå‘å±•å’Œç¤¾ä¼šç¨³å®šã€‚ä¸ºäº†ç¡®ä¿é£Ÿå“çš„å®‰å…¨æ€§å’Œåˆè§„æ€§ï¼Œå„å›½çº·çº·åˆ¶å®šäº†ä¸¥æ ¼çš„é£Ÿå“å®‰å…¨æ ‡å‡†å’Œæ ‡ç­¾åˆ¶åº¦ã€‚è¿™äº›æ ‡ç­¾ä¸ä»…æä¾›äº†é£Ÿå“çš„æˆåˆ†ã€æ¥æºå’Œç”Ÿäº§è¿‡ç¨‹ç­‰å…³é”®ä¿¡æ¯ï¼Œè¿˜èƒ½å¸®åŠ©æ¶ˆè´¹è€…åšå‡ºæ˜Žæ™ºçš„é€‰æ‹©ã€‚ç„¶è€Œï¼Œéšç€å¸‚åœºä¸Šé£Ÿå“ç§ç±»çš„å¤šæ ·åŒ–å’Œæ ‡ç­¾ä¿¡æ¯çš„å¤æ‚åŒ–ï¼Œä¼ ç»Ÿçš„äººå·¥å®¡æ ¸å’Œæ£€æµ‹æ–¹æ³•å·²ç»éš¾ä»¥æ»¡è¶³å¿«é€Ÿã€å‡†ç¡®çš„éœ€æ±‚ã€‚å› æ­¤ï¼ŒåŸºäºŽè®¡ç®—æœºè§†è§‰æŠ€æœ¯çš„è‡ªåŠ¨åŒ–é£Ÿå“å®‰å…¨æ ‡ç­¾æ£€æµ‹ç³»ç»Ÿåº”è¿è€Œç”Ÿã€‚

åœ¨è¿™ä¸€èƒŒæ™¯ä¸‹ï¼ŒYOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—ç›®æ ‡æ£€æµ‹ç®—æ³•å› å…¶é«˜æ•ˆæ€§å’Œå‡†ç¡®æ€§è€Œå—åˆ°å¹¿æ³›å…³æ³¨ã€‚YOLOv8ä½œä¸ºè¯¥ç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¿›ä¸€æ­¥æå‡äº†æ£€æµ‹ç²¾åº¦å’Œé€Ÿåº¦ï¼Œå°¤å…¶é€‚ç”¨äºŽå®žæ—¶åº”ç”¨åœºæ™¯ã€‚é€šè¿‡å¯¹YOLOv8çš„æ”¹è¿›ï¼Œå¯ä»¥æ›´å¥½åœ°é€‚åº”é£Ÿå“å®‰å…¨æ ‡ç­¾çš„å¤šæ ·æ€§å’Œå¤æ‚æ€§ï¼Œæå‡æ ‡ç­¾æ£€æµ‹çš„å‡†ç¡®çŽ‡å’Œæ•ˆçŽ‡ã€‚æœ¬æ–‡æ—¨åœ¨åŸºäºŽæ”¹è¿›çš„YOLOv8ç®—æ³•ï¼Œæž„å»ºä¸€ä¸ªé«˜æ•ˆçš„é£Ÿå“å®‰å…¨æ ‡ç­¾æ£€æµ‹ç³»ç»Ÿï¼Œä»¥æ»¡è¶³çŽ°ä»£é£Ÿå“è¡Œä¸šå¯¹æ ‡ç­¾æ£€æµ‹çš„è¿«åˆ‡éœ€æ±‚ã€‚

æœ¬ç ”ç©¶æ‰€ä½¿ç”¨çš„æ•°æ®é›†åŒ…å«1600å¼ å›¾åƒï¼Œæ¶µç›–äº†11ä¸ªç±»åˆ«çš„é£Ÿå“å®‰å…¨æ ‡ç­¾ï¼ŒåŒ…æ‹¬HACCPï¼ˆå±å®³åˆ†æžä¸Žå…³é”®æŽ§åˆ¶ç‚¹ï¼‰ã€KHSAï¼ˆéŸ©å›½é£Ÿå“å®‰å…¨è®¤è¯ï¼‰ã€NON_GMOï¼ˆéžè½¬åŸºå› ï¼‰ã€NSFï¼ˆå›½å®¶å«ç”ŸåŸºé‡‘ä¼šï¼‰ã€USDAï¼ˆç¾Žå›½å†œä¸šéƒ¨ï¼‰ã€USPï¼ˆç¾Žå›½è¯å…¸ï¼‰ã€GMPï¼ˆè‰¯å¥½ç”Ÿäº§è§„èŒƒï¼‰ã€å¥åº·åŠŸèƒ½æ ‡ç­¾ã€å„¿ç«¥é£Ÿå“æ ‡ç­¾ã€æœ‰æœºé£Ÿå“æ ‡ç­¾å’Œæœ‰æœºåŠ å·¥æ ‡ç­¾ç­‰ã€‚è¿™äº›æ ‡ç­¾çš„å¤šæ ·æ€§ä¸ºæ¨¡åž‹çš„è®­ç»ƒå’Œæµ‹è¯•æä¾›äº†ä¸°å¯Œçš„æ ·æœ¬ï¼Œæœ‰åŠ©äºŽæé«˜æ£€æµ‹ç³»ç»Ÿçš„æ³›åŒ–èƒ½åŠ›å’Œé€‚åº”æ€§ã€‚

é€šè¿‡å¯¹è¯¥æ•°æ®é›†çš„æ·±å…¥åˆ†æžå’Œå¤„ç†ï¼Œæœ¬æ–‡å°†æŽ¢è®¨å¦‚ä½•ä¼˜åŒ–YOLOv8çš„ç½‘ç»œç»“æž„å’Œè®­ç»ƒç­–ç•¥ï¼Œä»¥æé«˜å…¶åœ¨é£Ÿå“å®‰å…¨æ ‡ç­¾æ£€æµ‹ä¸­çš„è¡¨çŽ°ã€‚ç ”ç©¶å°†é‡ç‚¹å…³æ³¨æ ‡ç­¾çš„å¤šæ ·æ€§å’Œå¤æ‚æ€§å¯¹æ£€æµ‹ç²¾åº¦çš„å½±å“ï¼Œå¹¶å°è¯•é€šè¿‡æ•°æ®å¢žå¼ºã€è¿ç§»å­¦ä¹ ç­‰æŠ€æœ¯æ‰‹æ®µï¼Œæå‡æ¨¡åž‹åœ¨ä¸åŒåœºæ™¯ä¸‹çš„é²æ£’æ€§ã€‚æ­¤å¤–ï¼Œç ”ç©¶è¿˜å°†æŽ¢è®¨å¦‚ä½•å°†æ£€æµ‹ç»“æžœä¸Žé£Ÿå“å®‰å…¨æ ‡å‡†ç›¸ç»“åˆï¼Œä¸ºé£Ÿå“ç”Ÿäº§ä¼ä¸šå’Œç›‘ç®¡æœºæž„æä¾›æœ‰æ•ˆçš„å†³ç­–æ”¯æŒã€‚

æœ¬ç ”ç©¶çš„æ„ä¹‰åœ¨äºŽï¼Œä¸ä»…ä¸ºé£Ÿå“å®‰å…¨æ ‡ç­¾çš„è‡ªåŠ¨åŒ–æ£€æµ‹æä¾›äº†ä¸€ç§æ–°çš„è§£å†³æ–¹æ¡ˆï¼Œè¿˜ä¸ºç›¸å…³é¢†åŸŸçš„ç ”ç©¶æä¾›äº†é‡è¦çš„ç†è®ºåŸºç¡€å’Œå®žè·µå‚è€ƒã€‚é€šè¿‡æž„å»ºé«˜æ•ˆçš„é£Ÿå“å®‰å…¨æ ‡ç­¾æ£€æµ‹ç³»ç»Ÿï¼Œå¯ä»¥æœ‰æ•ˆé™ä½Žäººå·¥å®¡æ ¸çš„æˆæœ¬ï¼Œæé«˜æ£€æµ‹æ•ˆçŽ‡ï¼Œè¿›è€ŒæŽ¨åŠ¨é£Ÿå“è¡Œä¸šçš„å¯æŒç»­å‘å±•ã€‚åŒæ—¶ï¼Œè¯¥ç³»ç»Ÿçš„æˆåŠŸåº”ç”¨ä¹Ÿå°†ä¸ºå…¶ä»–é¢†åŸŸçš„æ ‡ç­¾æ£€æµ‹æä¾›å€Ÿé‰´ï¼Œä¿ƒè¿›è®¡ç®—æœºè§†è§‰æŠ€æœ¯åœ¨æ›´å¤šè¡Œä¸šçš„å¹¿æ³›åº”ç”¨ã€‚æ€»ä¹‹ï¼Œæœ¬ç ”ç©¶ä¸ä»…å…·æœ‰é‡è¦çš„å­¦æœ¯ä»·å€¼ï¼Œä¹Ÿå…·æœ‰å¹¿æ³›çš„ç¤¾ä¼šå’Œç»æµŽæ„ä¹‰ã€‚

### 2.å›¾ç‰‡æ¼”ç¤º

![1.png](1.png)

![2.png](2.png)

![3.png](3.png)

##### æ³¨æ„ï¼šç”±äºŽæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ2.å›¾ç‰‡æ¼”ç¤ºâ€å’Œâ€œ3.è§†é¢‘æ¼”ç¤ºâ€å±•ç¤ºçš„ç³»ç»Ÿå›¾ç‰‡æˆ–è€…è§†é¢‘å¯èƒ½ä¸ºè€ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬åœ¨è€ç‰ˆæœ¬çš„åŸºç¡€ä¸Šå‡çº§å¦‚ä¸‹ï¼šï¼ˆå®žé™…æ•ˆæžœä»¥å‡çº§çš„æ–°ç‰ˆæœ¬ä¸ºå‡†ï¼‰

  ï¼ˆ1ï¼‰é€‚é…äº†YOLOV8çš„â€œç›®æ ‡æ£€æµ‹â€æ¨¡åž‹å’Œâ€œå®žä¾‹åˆ†å‰²â€æ¨¡åž‹ï¼Œé€šè¿‡åŠ è½½ç›¸åº”çš„æƒé‡ï¼ˆ.ptï¼‰æ–‡ä»¶å³å¯è‡ªé€‚åº”åŠ è½½æ¨¡åž‹ã€‚

  ï¼ˆ2ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®žæ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«æ¨¡å¼ã€‚

  ï¼ˆ3ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®žæ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«ç»“æžœä¿å­˜å¯¼å‡ºï¼Œè§£å†³æ‰‹åŠ¨å¯¼å‡ºï¼ˆå®¹æ˜“å¡é¡¿å‡ºçŽ°çˆ†å†…å­˜ï¼‰å­˜åœ¨çš„é—®é¢˜ï¼Œè¯†åˆ«å®Œè‡ªåŠ¨ä¿å­˜ç»“æžœå¹¶å¯¼å‡ºåˆ°tempDirä¸­ã€‚

  ï¼ˆ4ï¼‰æ”¯æŒWebå‰ç«¯ç³»ç»Ÿä¸­çš„æ ‡é¢˜ã€èƒŒæ™¯å›¾ç­‰è‡ªå®šä¹‰ä¿®æ”¹ï¼ŒåŽé¢æä¾›ä¿®æ”¹æ•™ç¨‹ã€‚

  å¦å¤–æœ¬é¡¹ç›®æä¾›è®­ç»ƒçš„æ•°æ®é›†å’Œè®­ç»ƒæ•™ç¨‹,æš‚ä¸æä¾›æƒé‡æ–‡ä»¶ï¼ˆbest.ptï¼‰,éœ€è¦æ‚¨æŒ‰ç…§æ•™ç¨‹è¿›è¡Œè®­ç»ƒåŽå®žçŽ°å›¾ç‰‡æ¼”ç¤ºå’ŒWebå‰ç«¯ç•Œé¢æ¼”ç¤ºçš„æ•ˆæžœã€‚

### 3.è§†é¢‘æ¼”ç¤º

[3.1 è§†é¢‘æ¼”ç¤º](https://www.bilibili.com/video/BV1sPtZeeEJH/)

### 4.æ•°æ®é›†ä¿¡æ¯å±•ç¤º

##### 4.1 æœ¬é¡¹ç›®æ•°æ®é›†è¯¦ç»†æ•°æ®ï¼ˆç±»åˆ«æ•°ï¼†ç±»åˆ«åï¼‰

nc: 11
names: ['HACCP', 'KHSA', 'NON_GMO', 'NSF', 'USDA', 'USP', 'gmp', 'health_func', 'kid', 'orga', 'orga_proc']


##### 4.2 æœ¬é¡¹ç›®æ•°æ®é›†ä¿¡æ¯ä»‹ç»

æ•°æ®é›†ä¿¡æ¯å±•ç¤º

åœ¨é£Ÿå“å®‰å…¨é¢†åŸŸï¼Œæ ‡ç­¾çš„å‡†ç¡®æ£€æµ‹ä¸Žè¯†åˆ«å¯¹äºŽç¡®ä¿æ¶ˆè´¹è€…å¥åº·å’Œé£Ÿå“è´¨é‡è‡³å…³é‡è¦ã€‚ä¸ºæ­¤ï¼Œæœ¬ç ”ç©¶é‡‡ç”¨äº†åä¸ºâ€œmerge__gen__allâ€çš„æ•°æ®é›†ï¼Œä»¥è®­ç»ƒå’Œæ”¹è¿›YOLOv8æ¨¡åž‹ï¼Œæ—¨åœ¨æå‡é£Ÿå“å®‰å…¨æ ‡ç­¾çš„æ£€æµ‹ç³»ç»Ÿçš„æ€§èƒ½ã€‚è¯¥æ•°æ®é›†çš„è®¾è®¡è€ƒè™‘äº†å¤šæ ·æ€§å’Œå®žç”¨æ€§ï¼ŒåŒ…å«äº†11ä¸ªä¸åŒçš„æ ‡ç­¾ç±»åˆ«ï¼Œæ¶µç›–äº†é£Ÿå“å®‰å…¨å’Œè´¨é‡çš„å„ä¸ªæ–¹é¢ã€‚è¿™äº›ç±»åˆ«åˆ†åˆ«ä¸ºï¼šHACCPï¼ˆå±å®³åˆ†æžä¸Žå…³é”®æŽ§åˆ¶ç‚¹ï¼‰ã€KHSAï¼ˆå…³é”®å¥åº·å’Œå®‰å…¨æ ‡å‡†ï¼‰ã€NON_GMOï¼ˆéžè½¬åŸºå› ï¼‰ã€NSFï¼ˆå›½å®¶å«ç”ŸåŸºé‡‘ä¼šï¼‰ã€USDAï¼ˆç¾Žå›½å†œä¸šéƒ¨ï¼‰ã€USPï¼ˆç¾Žå›½è¯å…¸ï¼‰ã€gmpï¼ˆè‰¯å¥½ç”Ÿäº§è§„èŒƒï¼‰ã€health_funcï¼ˆå¥åº·åŠŸèƒ½ï¼‰ã€kidï¼ˆå„¿ç«¥ï¼‰ã€orgaï¼ˆæœ‰æœºï¼‰ã€orga_procï¼ˆæœ‰æœºåŠ å·¥ï¼‰ã€‚

æ•°æ®é›†çš„å¤šæ ·æ€§ä½“çŽ°åœ¨å…¶æ¶µç›–çš„æ ‡ç­¾ç§ç±»ä¸Šï¼Œè¿™äº›æ ‡ç­¾ä¸ä»…åæ˜ äº†é£Ÿå“çš„å®‰å…¨æ€§å’Œè´¨é‡æ ‡å‡†ï¼Œè¿˜æ¶‰åŠåˆ°æ¶ˆè´¹è€…çš„å¥åº·éœ€æ±‚å’Œå¸‚åœºè¶‹åŠ¿ã€‚ä¾‹å¦‚ï¼ŒHACCPæ ‡ç­¾ä»£è¡¨äº†å¯¹é£Ÿå“ç”Ÿäº§è¿‡ç¨‹ä¸­çš„å±å®³è¿›è¡Œç³»ç»Ÿæ€§åˆ†æžçš„æ ‡å‡†ï¼Œè€ŒNON_GMOæ ‡ç­¾åˆ™æ˜¯è¶Šæ¥è¶Šå¤šæ¶ˆè´¹è€…å…³æ³¨çš„éžè½¬åŸºå› é£Ÿå“çš„æ ‡å¿—ã€‚é€šè¿‡å¯¹è¿™äº›æ ‡ç­¾çš„æ£€æµ‹ï¼Œç ”ç©¶è€…èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£å’Œåˆ†æžé£Ÿå“äº§å“çš„åˆè§„æ€§å’Œå¸‚åœºå®šä½ã€‚

æ­¤å¤–ï¼Œæ•°æ®é›†ä¸­çš„æ¯ä¸ªç±»åˆ«éƒ½ç»è¿‡ç²¾å¿ƒæ ‡æ³¨ï¼Œç¡®ä¿äº†è®­ç»ƒæ•°æ®çš„é«˜è´¨é‡ã€‚è¿™äº›æ ‡ç­¾çš„å‡†ç¡®æ€§å’Œä¸€è‡´æ€§å¯¹äºŽYOLOv8æ¨¡åž‹çš„è®­ç»ƒè‡³å…³é‡è¦ï¼Œå› ä¸ºæ¨¡åž‹çš„æ€§èƒ½åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äºŽè¾“å…¥æ•°æ®çš„è´¨é‡ã€‚é€šè¿‡ä½¿ç”¨â€œmerge__gen__allâ€æ•°æ®é›†ï¼Œç ”ç©¶è€…èƒ½å¤Ÿæœ‰æ•ˆåœ°è®­ç»ƒæ¨¡åž‹ï¼Œä½¿å…¶åœ¨å®žé™…åº”ç”¨ä¸­èƒ½å¤Ÿå¿«é€Ÿã€å‡†ç¡®åœ°è¯†åˆ«å’Œåˆ†ç±»å„ç§é£Ÿå“å®‰å…¨æ ‡ç­¾ã€‚

åœ¨æ•°æ®é›†çš„æž„å»ºè¿‡ç¨‹ä¸­ï¼Œç ”ç©¶å›¢é˜Ÿè¿˜ç‰¹åˆ«å…³æ³¨äº†æ•°æ®çš„å¹³è¡¡æ€§å’Œä»£è¡¨æ€§ï¼Œç¡®ä¿æ¯ä¸ªç±»åˆ«éƒ½æœ‰è¶³å¤Ÿçš„æ ·æœ¬é‡ï¼Œä»¥é¿å…æ¨¡åž‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å‡ºçŽ°åå€šã€‚è¿™ç§å¹³è¡¡æ€§ä¸ä»…æé«˜äº†æ¨¡åž‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œè¿˜å¢žå¼ºäº†å…¶åœ¨å®žé™…åº”ç”¨ä¸­çš„å¯é æ€§ã€‚é€šè¿‡å¼•å…¥å¤šæ ·åŒ–çš„æ ·æœ¬ï¼Œæ¨¡åž‹èƒ½å¤Ÿå­¦ä¹ åˆ°ä¸åŒæ ‡ç­¾çš„ç‰¹å¾ï¼Œä»Žè€Œåœ¨é¢å¯¹å„ç§å¤æ‚çš„é£Ÿå“æ ‡ç­¾æ—¶ï¼Œä¾ç„¶èƒ½å¤Ÿä¿æŒé«˜æ•ˆçš„æ£€æµ‹èƒ½åŠ›ã€‚

åœ¨æ¨¡åž‹è®­ç»ƒå®ŒæˆåŽï¼Œç ”ç©¶è€…å°†å¯¹å…¶è¿›è¡Œä¸¥æ ¼çš„æµ‹è¯•ä¸ŽéªŒè¯ï¼Œä»¥è¯„ä¼°å…¶åœ¨çœŸå®žåœºæ™¯ä¸­çš„è¡¨çŽ°ã€‚é€šè¿‡ä¸ŽçŽ°æœ‰çš„é£Ÿå“å®‰å…¨æ ‡ç­¾æ£€æµ‹ç³»ç»Ÿè¿›è¡Œå¯¹æ¯”ï¼Œç ”ç©¶å›¢é˜Ÿå¸Œæœ›èƒ½å¤Ÿå±•ç¤ºæ”¹è¿›åŽçš„YOLOv8æ¨¡åž‹åœ¨å‡†ç¡®æ€§ã€é€Ÿåº¦å’Œé²æ£’æ€§æ–¹é¢çš„ä¼˜åŠ¿ã€‚è¿™ä¸ä»…ä¸ºé£Ÿå“è¡Œä¸šæä¾›äº†æ›´ä¸ºå…ˆè¿›çš„æŠ€æœ¯æ”¯æŒï¼Œä¹Ÿä¸ºæ¶ˆè´¹è€…çš„é£Ÿå“å®‰å…¨æä¾›äº†æ›´ä¸ºå¯é çš„ä¿éšœã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œâ€œmerge__gen__allâ€æ•°æ®é›†åœ¨æœ¬ç ”ç©¶ä¸­æ‰®æ¼”äº†è‡³å…³é‡è¦çš„è§’è‰²ã€‚å®ƒä¸ä»…ä¸ºYOLOv8æ¨¡åž‹çš„è®­ç»ƒæä¾›äº†ä¸°å¯Œçš„æ ·æœ¬å’Œæ ‡ç­¾ä¿¡æ¯ï¼Œè¿˜ä¸ºé£Ÿå“å®‰å…¨æ ‡ç­¾æ£€æµ‹ç³»ç»Ÿçš„æ”¹è¿›å¥ å®šäº†åšå®žçš„åŸºç¡€ã€‚é€šè¿‡ä¸æ–­ä¼˜åŒ–å’Œè°ƒæ•´æ¨¡åž‹ï¼Œç ”ç©¶å›¢é˜ŸæœŸå¾…èƒ½å¤Ÿåœ¨é£Ÿå“å®‰å…¨é¢†åŸŸå–å¾—çªç ´æ€§è¿›å±•ï¼Œä¸ºæ¶ˆè´¹è€…çš„å¥åº·ä¿é©¾æŠ¤èˆªã€‚

![4.png](4.png)

![5.png](5.png)

![6.png](6.png)

![7.png](7.png)

![8.png](8.png)

### 5.å…¨å¥—é¡¹ç›®çŽ¯å¢ƒéƒ¨ç½²è§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰

[5.1 çŽ¯å¢ƒéƒ¨ç½²æ•™ç¨‹é“¾æŽ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404473917358506534?logTag=c807d0cbc21c0ef59de5)




[5.2 å®‰è£…Pythonè™šæ‹ŸçŽ¯å¢ƒåˆ›å»ºå’Œä¾èµ–åº“å®‰è£…è§†é¢‘æ•™ç¨‹é“¾æŽ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404474678003106304?logTag=1f1041108cd1f708b01a)

### 6.æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰

[6.1 æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰](https://www.ixigua.com/7404477157818401292?logTag=d31a2dfd1983c9668658)

### 7.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡åž‹çš„é…ç½®æ–‡ä»¶ï¼‰

[7.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡åž‹çš„é…ç½®æ–‡ä»¶ï¼‰](https://www.ixigua.com/7404478314661806627?logTag=29066f8288e3f4eea3a4)

### 8.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŽŸç†è®²è§£ï¼ˆéžç§‘ç­ä¹Ÿå¯ä»¥è½»æ¾å†™åˆŠå‘åˆŠï¼ŒV10ç‰ˆæœ¬æ­£åœ¨ç§‘ç ”å¾…æ›´æ–°ï¼‰

ç”±äºŽç¯‡å¹…é™åˆ¶ï¼Œæ¯ä¸ªåˆ›æ–°ç‚¹çš„å…·ä½“åŽŸç†è®²è§£å°±ä¸ä¸€ä¸€å±•å¼€ï¼Œå…·ä½“è§ä¸‹åˆ—ç½‘å€ä¸­çš„åˆ›æ–°ç‚¹å¯¹åº”å­é¡¹ç›®çš„æŠ€æœ¯åŽŸç†åšå®¢ç½‘å€ã€Blogã€‘ï¼š

![9.png](9.png)

[8.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŽŸç†è®²è§£é“¾æŽ¥](https://gitee.com/qunmasj/good)

### 9.ç³»ç»ŸåŠŸèƒ½å±•ç¤ºï¼ˆæ£€æµ‹å¯¹è±¡ä¸ºä¸¾ä¾‹ï¼Œå®žé™…å†…å®¹ä»¥æœ¬é¡¹ç›®æ•°æ®é›†ä¸ºå‡†ï¼‰

å›¾9.1.ç³»ç»Ÿæ”¯æŒæ£€æµ‹ç»“æžœè¡¨æ ¼æ˜¾ç¤º

  å›¾9.2.ç³»ç»Ÿæ”¯æŒç½®ä¿¡åº¦å’ŒIOUé˜ˆå€¼æ‰‹åŠ¨è°ƒèŠ‚

  å›¾9.3.ç³»ç»Ÿæ”¯æŒè‡ªå®šä¹‰åŠ è½½æƒé‡æ–‡ä»¶best.pt(éœ€è¦ä½ é€šè¿‡æ­¥éª¤5ä¸­è®­ç»ƒèŽ·å¾—)

  å›¾9.4.ç³»ç»Ÿæ”¯æŒæ‘„åƒå¤´å®žæ—¶è¯†åˆ«

  å›¾9.5.ç³»ç»Ÿæ”¯æŒå›¾ç‰‡è¯†åˆ«

  å›¾9.6.ç³»ç»Ÿæ”¯æŒè§†é¢‘è¯†åˆ«

  å›¾9.7.ç³»ç»Ÿæ”¯æŒè¯†åˆ«ç»“æžœæ–‡ä»¶è‡ªåŠ¨ä¿å­˜

  å›¾9.8.ç³»ç»Ÿæ”¯æŒExcelå¯¼å‡ºæ£€æµ‹ç»“æžœæ•°æ®

![10.png](10.png)

![11.png](11.png)

![12.png](12.png)

![13.png](13.png)

![14.png](14.png)

![15.png](15.png)

![16.png](16.png)

![17.png](17.png)

### 10.åŽŸå§‹YOLOV8ç®—æ³•åŽŸç†

åŽŸå§‹YOLOv8ç®—æ³•åŽŸç†

YOLOv8ç®—æ³•æ˜¯Ultralyticså…¬å¸åœ¨2023å¹´åˆæŽ¨å‡ºçš„æœ€æ–°ç‰ˆæœ¬ç›®æ ‡æ£€æµ‹æ¨¡åž‹ï¼Œæ ‡å¿—ç€YOLOç³»åˆ—ç®—æ³•åœ¨ç²¾åº¦å’Œé€Ÿåº¦ä¸Šçš„åˆä¸€æ¬¡é£žè·ƒã€‚è¯¥ç®—æ³•åœ¨YOLOv7çš„åŸºç¡€ä¸Šè¿›è¡Œäº†æ·±åº¦ä¼˜åŒ–ï¼Œé‡‡ç”¨äº†æ›´ä¸ºå¤æ‚å’Œé«˜æ•ˆçš„å·ç§¯ç¥žç»ç½‘ç»œç»“æž„ï¼Œä½¿å¾—ç›®æ ‡æ£€æµ‹çš„æ€§èƒ½å¾—åˆ°äº†æ˜¾è‘—æå‡ã€‚YOLOv8çš„è®¾è®¡ç†å¿µæ˜¯å°†æ•´ä¸ªå›¾åƒä½œä¸ºè¾“å…¥ï¼Œç›´æŽ¥åœ¨å›¾åƒä¸Šè¿›è¡Œç›®æ ‡æ£€æµ‹å’Œå®šä½ï¼Œè€Œä¸éœ€è¦ä¼ ç»Ÿçš„æ»‘åŠ¨çª—å£æˆ–åŒºåŸŸæè®®æ–¹æ³•ï¼Œè¿™ä¸€åˆ›æ–°æ˜¾è‘—æé«˜äº†æ£€æµ‹çš„é€Ÿåº¦å’Œç²¾åº¦ã€‚

YOLOv8çš„ç½‘ç»œç»“æž„ç”±å¤šä¸ªä¸»è¦ç»„ä»¶æž„æˆï¼ŒåŒ…æ‹¬è¾“å…¥å±‚ã€ä¸»å¹²ç½‘ç»œã€é¢ˆéƒ¨ç½‘ç»œå’Œå¤´éƒ¨ç½‘ç»œã€‚è¾“å…¥å±‚è´Ÿè´£å°†åŽŸå§‹å›¾åƒç¼©æ”¾åˆ°æŒ‡å®šçš„è¾“å…¥å°ºå¯¸ï¼Œä»¥é€‚åº”åŽç»­çš„å¤„ç†éœ€æ±‚ã€‚ä¸»å¹²ç½‘ç»œæ˜¯YOLOv8çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œé€šè¿‡å¤šå±‚å·ç§¯æ“ä½œå¯¹è¾“å…¥å›¾åƒè¿›è¡Œä¸‹é‡‡æ ·ï¼Œä»Žè€Œæå–å‡ºä¸°å¯Œçš„ç‰¹å¾ä¿¡æ¯ã€‚æ¯ä¸ªå·ç§¯å±‚éƒ½åŒ…å«æ‰¹å½’ä¸€åŒ–å’ŒSiLUæ¿€æ´»å‡½æ•°ï¼Œè¿™ç§è®¾è®¡ä¸ä»…åŠ é€Ÿäº†è®­ç»ƒè¿‡ç¨‹ï¼Œè¿˜æé«˜äº†æ¨¡åž‹çš„æ”¶æ•›é€Ÿåº¦å’Œæœ€ç»ˆçš„æ£€æµ‹ç²¾åº¦ã€‚

åœ¨ä¸»å¹²ç½‘ç»œä¸­ï¼ŒYOLOv8å¼•å…¥äº†C2få—ï¼Œè¿™ä¸€æ¨¡å—å€Ÿé‰´äº†YOLOv7ä¸­çš„E-ELANç»“æž„ï¼Œé€šè¿‡è·¨å±‚åˆ†æ”¯è¿žæŽ¥çš„æ–¹å¼å¢žå¼ºäº†æ¨¡åž‹çš„æ¢¯åº¦æµåŠ¨æ€§ã€‚è¿™ç§è®¾è®¡æœ‰æ•ˆåœ°æ”¹å–„äº†ç‰¹å¾çš„ä¼ é€’ï¼Œä½¿å¾—æ¨¡åž‹åœ¨é¢å¯¹å¤æ‚åœºæ™¯æ—¶èƒ½å¤Ÿæ›´å¥½åœ°æ•æ‰ç›®æ ‡ç‰¹å¾ã€‚æ­¤å¤–ï¼Œä¸»å¹²ç½‘ç»œæœ«å°¾çš„SPPFlå—ä½¿ç”¨äº†ä¸‰ä¸ªæœ€å¤§æ± åŒ–å±‚ï¼Œè¿›ä¸€æ­¥å¢žå¼ºäº†ç½‘ç»œçš„ç‰¹å¾æŠ½è±¡èƒ½åŠ›ï¼Œèƒ½å¤Ÿå¤„ç†å¤šå°ºåº¦çš„ç‰¹å¾ä¿¡æ¯ï¼Œä»Žè€Œæå‡äº†å¯¹ä¸åŒå¤§å°ç›®æ ‡çš„æ£€æµ‹èƒ½åŠ›ã€‚

é¢ˆéƒ¨ç½‘ç»œåˆ™é‡‡ç”¨äº†ç‰¹å¾é‡‘å­—å¡”ç½‘ç»œï¼ˆFPNï¼‰å’Œè·¯å¾„èšåˆç½‘ç»œï¼ˆPANï¼‰ç»“æž„ï¼Œè¿™ä¸€è®¾è®¡æ—¨åœ¨èžåˆæ¥è‡ªä¸åŒå°ºåº¦ç‰¹å¾å›¾çš„ä¿¡æ¯ï¼Œä»¥ä¾¿æ›´å…¨é¢åœ°æ•æ‰ç›®æ ‡çš„å¤šæ ·æ€§ã€‚é€šè¿‡è¿™ç§ç‰¹å¾èžåˆï¼ŒYOLOv8èƒ½å¤Ÿåœ¨ä¸åŒçš„å±‚æ¬¡ä¸Šå¯¹ç›®æ ‡è¿›è¡Œæ£€æµ‹ï¼Œç¡®ä¿åœ¨å¤æ‚èƒŒæ™¯ä¸‹ä¹Ÿèƒ½ä¿æŒé«˜æ•ˆçš„æ£€æµ‹æ€§èƒ½ã€‚æœ€åŽï¼ŒYOLOv8çš„å¤´éƒ¨ç½‘ç»œé‡‡ç”¨äº†è§£è€¦çš„æ£€æµ‹å¤´ï¼Œåˆ†åˆ«é€šè¿‡ä¸¤ä¸ªå¹¶è¡Œçš„å·ç§¯åˆ†æ”¯è®¡ç®—å›žå½’å’Œç±»åˆ«çš„æŸå¤±ï¼Œè¿™ç§è®¾è®¡ä½¿å¾—æ¨¡åž‹åœ¨å¤„ç†ç›®æ ‡æ£€æµ‹ä»»åŠ¡æ—¶æ›´åŠ çµæ´»å’Œé«˜æ•ˆã€‚

åœ¨å®žé™…åº”ç”¨ä¸­ï¼ŒYOLOv8çš„å¤šå°ºåº¦è®­ç»ƒå’Œæµ‹è¯•ç­–ç•¥ä½¿å¾—æ¨¡åž‹èƒ½å¤Ÿåœ¨ä¸åŒçš„çŽ¯å¢ƒå’Œæ¡ä»¶ä¸‹è¡¨çŽ°å‡ºè‰²ã€‚è¿™ä¸€ç­–ç•¥ä¸ä»…æå‡äº†æ¨¡åž‹çš„é²æ£’æ€§ï¼Œè¿˜æœ‰æ•ˆé™ä½Žäº†è¿‡æ‹Ÿåˆçš„é£Žé™©ï¼Œä½¿å¾—YOLOv8åœ¨å„ç§åœºæ™¯ä¸‹éƒ½èƒ½ä¿æŒé«˜ç²¾åº¦çš„æ£€æµ‹æ€§èƒ½ã€‚ä¸Žå…¶ä»–ç›®æ ‡æ£€æµ‹ç®—æ³•ç›¸æ¯”ï¼ŒYOLOv8åœ¨ç²¾åº¦å’Œå¸§çŽ‡ä¸Šå‡æœ‰æ˜¾è‘—æå‡ï¼Œæ•°æ®æ˜¾ç¤ºå…¶ç²¾åº¦æé«˜äº†43.23%ï¼Œå¸§çŽ‡åˆ™æå‡äº†10.28å€ï¼Œè¿™ä¸€ä¼˜åŠ¿ä½¿å¾—YOLOv8åœ¨æ™ºèƒ½ç›‘æŽ§ã€è‡ªåŠ¨é©¾é©¶ã€äººè„¸è¯†åˆ«ç­‰é¢†åŸŸå±•çŽ°å‡ºå¹¿æ³›çš„åº”ç”¨æ½œåŠ›ã€‚

YOLOv8çš„è®¾è®¡ä¸ä»…æ˜¯å¯¹YOLOç³»åˆ—ç®—æ³•çš„å»¶ç»­ï¼Œæ›´æ˜¯å¯¹ç›®æ ‡æ£€æµ‹é¢†åŸŸçš„ä¸€æ¬¡é‡è¦åˆ›æ–°ã€‚å®ƒé›†åˆäº†YOLOXã€YOLOv6ã€YOLOv7åŠPP-YOLOEç­‰ç®—æ³•çš„ä¼˜ç‚¹ï¼Œå°¤å…¶åœ¨Headæ ‡ç­¾åˆ†é…å’ŒLossè®¡ç®—éƒ¨åˆ†ï¼ŒYOLOv8ä¸ŽPP-YOLOEæœ‰ç€è¾ƒé«˜çš„ç›¸ä¼¼æ€§ã€‚è¿™ç§é›†æˆå¼çš„è®¾è®¡ç†å¿µä½¿å¾—YOLOv8åœ¨ä¿æŒé«˜ç²¾åº¦çš„åŒæ—¶ï¼Œè¿›ä¸€æ­¥æå‡äº†æ£€æµ‹é€Ÿåº¦ï¼Œè¾¾åˆ°äº†å®žæ—¶æ£€æµ‹çš„æ–°é«˜åº¦ã€‚

åœ¨å®žé™…åº”ç”¨æ¡ˆä¾‹ä¸­ï¼ŒYOLOv8è¢«å¹¿æ³›åº”ç”¨äºŽè‹¹æžœé‡‡æ‘˜ç­‰åœºæ™¯ï¼Œåˆ©ç”¨å…¶å¼ºå¤§çš„è§†è§‰è¯†åˆ«èƒ½åŠ›ï¼Œè‡ªåŠ¨æ£€æµ‹å’Œå®šä½è‹¹æžœï¼Œä¸ºè‡ªåŠ¨é‡‡æ‘˜æœºå™¨äººæä¾›äº†ç²¾å‡†çš„ç›®æ ‡ä¿¡æ¯ã€‚ä¸ºäº†æé«˜é‡‡æ‘˜æ•ˆçŽ‡ï¼Œç»“åˆèšç¾¤ç®—æ³•è¿›è¡Œè·¯å¾„è§„åˆ’ï¼Œä½¿å¾—æœºå™¨äººèƒ½å¤Ÿå¿«é€Ÿã€å‡†ç¡®åœ°å®Œæˆè‹¹æžœçš„é‡‡æ‘˜ä»»åŠ¡ã€‚è¿™ä¸€åº”ç”¨ä¸ä»…å±•ç¤ºäº†YOLOv8åœ¨å†œä¸šé¢†åŸŸçš„æ½œåŠ›ï¼Œä¹Ÿä¸ºæœªæ¥çš„æ™ºèƒ½å†œä¸šå‘å±•æä¾›äº†æ–°çš„æ€è·¯ã€‚

æ€»ä¹‹ï¼ŒYOLOv8ç®—æ³•é€šè¿‡å…¶æ·±åº¦ä¼˜åŒ–çš„ç½‘ç»œç»“æž„å’Œåˆ›æ–°çš„è®¾è®¡ç†å¿µï¼Œæžå¤§åœ°æå‡äº†ç›®æ ‡æ£€æµ‹çš„æ€§èƒ½ã€‚å…¶åœ¨ç²¾åº¦å’Œé€Ÿåº¦ä¸Šçš„åŒé‡ä¼˜åŠ¿ï¼Œä½¿å¾—YOLOv8æˆä¸ºå½“å‰ç›®æ ‡æ£€æµ‹é¢†åŸŸçš„ä¸€æ¬¾é‡è¦å·¥å…·ï¼Œå…·æœ‰å¹¿æ³›çš„åº”ç”¨å‰æ™¯å’Œç ”ç©¶ä»·å€¼ã€‚éšç€æŠ€æœ¯çš„ä¸æ–­è¿›æ­¥ï¼ŒYOLOv8å°†ä¸ºæ›´å¤šå®žé™…åº”ç”¨åœºæ™¯æä¾›æ”¯æŒï¼ŒæŽ¨åŠ¨ç›®æ ‡æ£€æµ‹æŠ€æœ¯çš„è¿›ä¸€æ­¥å‘å±•ã€‚

![18.png](18.png)

### 11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰

#### 11.1 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéžå¿…è¦ï¼‰\ultralytics\models\fastsam\predict.py

ä»¥ä¸‹æ˜¯å¯¹ä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†è¿›è¡Œæç‚¼å’Œè¯¦ç»†æ³¨é‡Šçš„ç»“æžœï¼š

```python
# å¯¼å…¥å¿…è¦çš„åº“
import torch
from ultralytics.engine.results import Results
from ultralytics.models.fastsam.utils import bbox_iou
from ultralytics.models.yolo.detect.predict import DetectionPredictor
from ultralytics.utils import ops

class FastSAMPredictor(DetectionPredictor):
    """
    FastSAMPredictorç±»ä¸“é—¨ç”¨äºŽåœ¨Ultralytics YOLOæ¡†æž¶ä¸­è¿›è¡Œå¿«é€ŸSAMï¼ˆSegment Anything Modelï¼‰åˆ†å‰²é¢„æµ‹ä»»åŠ¡ã€‚
    è¯¥ç±»ç»§æ‰¿è‡ªDetectionPredictorï¼Œå®šåˆ¶äº†é¢„æµ‹ç®¡é“ï¼Œç‰¹åˆ«é’ˆå¯¹å¿«é€ŸSAMè¿›è¡Œäº†è°ƒæ•´ã€‚
    """

    def __init__(self, cfg=DEFAULT_CFG, overrides=None, _callbacks=None):
        """
        åˆå§‹åŒ–FastSAMPredictorç±»ï¼Œè®¾ç½®ä»»åŠ¡ä¸º'åˆ†å‰²'ã€‚
        
        Args:
            cfg (dict): é¢„æµ‹çš„é…ç½®å‚æ•°ã€‚
            overrides (dict, optional): å¯é€‰çš„å‚æ•°è¦†ç›–ä»¥å®žçŽ°è‡ªå®šä¹‰è¡Œä¸ºã€‚
            _callbacks (dict, optional): åœ¨é¢„æµ‹è¿‡ç¨‹ä¸­è°ƒç”¨çš„å¯é€‰å›žè°ƒå‡½æ•°åˆ—è¡¨ã€‚
        """
        super().__init__(cfg, overrides, _callbacks)  # è°ƒç”¨çˆ¶ç±»æž„é€ å‡½æ•°
        self.args.task = 'segment'  # è®¾ç½®ä»»åŠ¡ä¸ºåˆ†å‰²

    def postprocess(self, preds, img, orig_imgs):
        """
        å¯¹æ¨¡åž‹çš„é¢„æµ‹ç»“æžœè¿›è¡ŒåŽå¤„ç†ï¼ŒåŒ…æ‹¬éžæžå¤§å€¼æŠ‘åˆ¶å’Œå°†æ¡†ç¼©æ”¾åˆ°åŽŸå§‹å›¾åƒå¤§å°ï¼Œå¹¶è¿”å›žæœ€ç»ˆç»“æžœã€‚
        
        Args:
            preds (list): æ¨¡åž‹çš„åŽŸå§‹è¾“å‡ºé¢„æµ‹ã€‚
            img (torch.Tensor): å¤„ç†åŽçš„å›¾åƒå¼ é‡ã€‚
            orig_imgs (list | torch.Tensor): åŽŸå§‹å›¾åƒæˆ–å›¾åƒåˆ—è¡¨ã€‚
        
        Returns:
            (list): åŒ…å«å¤„ç†åŽçš„æ¡†ã€æŽ©ç å’Œå…¶ä»–å…ƒæ•°æ®çš„Resultså¯¹è±¡åˆ—è¡¨ã€‚
        """
        # è¿›è¡Œéžæžå¤§å€¼æŠ‘åˆ¶ï¼Œè¿‡æ»¤æŽ‰ä½Žç½®ä¿¡åº¦çš„é¢„æµ‹
        p = ops.non_max_suppression(
            preds[0],
            self.args.conf,
            self.args.iou,
            agnostic=self.args.agnostic_nms,
            max_det=self.args.max_det,
            nc=1,  # SAMæ²¡æœ‰ç±»åˆ«é¢„æµ‹ï¼Œå› æ­¤è®¾ç½®ä¸º1ç±»
            classes=self.args.classes
        )

        # åˆ›å»ºä¸€ä¸ªå…¨æ¡†ï¼ŒåŒ…å«å›¾åƒçš„å®½é«˜ä¿¡æ¯
        full_box = torch.zeros(p[0].shape[1], device=p[0].device)
        full_box[2], full_box[3], full_box[4], full_box[6:] = img.shape[3], img.shape[2], 1.0, 1.0
        full_box = full_box.view(1, -1)

        # è®¡ç®—ä¸Žå…¨æ¡†çš„IoUï¼Œå¹¶æ ¹æ®é˜ˆå€¼æ›´æ–°full_box
        critical_iou_index = bbox_iou(full_box[0][:4], p[0][:, :4], iou_thres=0.9, image_shape=img.shape[2:])
        if critical_iou_index.numel() != 0:
            full_box[0][4] = p[0][critical_iou_index][:, 4]
            full_box[0][6:] = p[0][critical_iou_index][:, 6:]
            p[0][critical_iou_index] = full_box  # æ›´æ–°é¢„æµ‹æ¡†

        # ç¡®ä¿åŽŸå§‹å›¾åƒæ˜¯numpyæ ¼å¼
        if not isinstance(orig_imgs, list):
            orig_imgs = ops.convert_torch2numpy_batch(orig_imgs)

        results = []  # å­˜å‚¨æœ€ç»ˆç»“æžœ
        proto = preds[1][-1] if len(preds[1]) == 3 else preds[1]  # èŽ·å–æŽ©ç åŽŸåž‹

        # éåŽ†æ¯ä¸ªé¢„æµ‹ç»“æžœ
        for i, pred in enumerate(p):
            orig_img = orig_imgs[i]  # èŽ·å–åŽŸå§‹å›¾åƒ
            img_path = self.batch[0][i]  # èŽ·å–å›¾åƒè·¯å¾„
            
            if not len(pred):  # å¦‚æžœæ²¡æœ‰é¢„æµ‹æ¡†
                masks = None
            elif self.args.retina_masks:  # å¦‚æžœä½¿ç”¨RetinaæŽ©ç 
                pred[:, :4] = ops.scale_boxes(img.shape[2:], pred[:, :4], orig_img.shape)  # ç¼©æ”¾æ¡†
                masks = ops.process_mask_native(proto[i], pred[:, 6:], pred[:, :4], orig_img.shape[:2])  # å¤„ç†æŽ©ç 
            else:  # å¦åˆ™ä½¿ç”¨å¸¸è§„æŽ©ç å¤„ç†
                masks = ops.process_mask(proto[i], pred[:, 6:], pred[:, :4], img.shape[2:], upsample=True)  # å¤„ç†æŽ©ç 
                pred[:, :4] = ops.scale_boxes(img.shape[2:], pred[:, :4], orig_img.shape)  # ç¼©æ”¾æ¡†
            
            # å°†ç»“æžœæ·»åŠ åˆ°ç»“æžœåˆ—è¡¨ä¸­
            results.append(Results(orig_img, path=img_path, names=self.model.names, boxes=pred[:, :6], masks=masks))
        
        return results  # è¿”å›žæœ€ç»ˆç»“æžœåˆ—è¡¨
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†åˆ†æžï¼š
1. **ç±»å®šä¹‰**ï¼š`FastSAMPredictor` ç»§æ‰¿è‡ª `DetectionPredictor`ï¼Œä¸“é—¨ç”¨äºŽå¿«é€Ÿçš„åˆ†å‰²ä»»åŠ¡ã€‚
2. **åˆå§‹åŒ–æ–¹æ³•**ï¼šè®¾ç½®ä»»åŠ¡ä¸ºåˆ†å‰²ï¼Œå¹¶è°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–æ–¹æ³•ã€‚
3. **åŽå¤„ç†æ–¹æ³•**ï¼š`postprocess` æ–¹æ³•è´Ÿè´£å¯¹æ¨¡åž‹çš„é¢„æµ‹ç»“æžœè¿›è¡ŒåŽå¤„ç†ï¼ŒåŒ…æ‹¬éžæžå¤§å€¼æŠ‘åˆ¶ã€æ¡†çš„ç¼©æ”¾å’ŒæŽ©ç çš„å¤„ç†ï¼Œæœ€ç»ˆè¿”å›žå¤„ç†åŽçš„ç»“æžœã€‚
4. **IoUè®¡ç®—**ï¼šä½¿ç”¨ `bbox_iou` å‡½æ•°è®¡ç®—ä¸Žå…¨æ¡†çš„IoUï¼Œå¹¶æ ¹æ®é˜ˆå€¼æ›´æ–°é¢„æµ‹æ¡†ã€‚
5. **ç»“æžœå­˜å‚¨**ï¼šå°†æ¯ä¸ªå›¾åƒçš„å¤„ç†ç»“æžœå­˜å‚¨åœ¨ `results` åˆ—è¡¨ä¸­ï¼Œå¹¶è¿”å›žã€‚

è¯¥æ–‡ä»¶æ˜¯Ultralytics YOLOæ¡†æž¶ä¸­ç”¨äºŽå¿«é€ŸSAMï¼ˆSegment Anything Modelï¼‰åˆ†å‰²é¢„æµ‹çš„å®žçŽ°ï¼Œä¸»è¦å®šä¹‰äº†ä¸€ä¸ªåä¸º`FastSAMPredictor`çš„ç±»ã€‚è¿™ä¸ªç±»ç»§æ‰¿è‡ª`DetectionPredictor`ï¼Œå¹¶å¯¹é¢„æµ‹æµç¨‹è¿›è¡Œäº†å®šåˆ¶ï¼Œä»¥é€‚åº”å¿«é€ŸSAMçš„éœ€æ±‚ã€‚

åœ¨åˆå§‹åŒ–æ–¹æ³•ä¸­ï¼Œ`FastSAMPredictor`æŽ¥æ”¶é…ç½®å‚æ•°ã€å¯é€‰çš„å‚æ•°è¦†ç›–å’Œå›žè°ƒå‡½æ•°ï¼Œå¹¶å°†ä»»åŠ¡ç±»åž‹è®¾ç½®ä¸ºâ€œåˆ†å‰²â€ã€‚è¿™æ„å‘³ç€è¯¥ç±»çš„ä¸»è¦åŠŸèƒ½æ˜¯å¤„ç†å›¾åƒåˆ†å‰²ä»»åŠ¡ï¼Œè€Œä¸æ˜¯å¸¸è§„çš„ç›®æ ‡æ£€æµ‹ã€‚

`postprocess`æ–¹æ³•æ˜¯è¯¥ç±»çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œè´Ÿè´£å¯¹æ¨¡åž‹çš„åŽŸå§‹é¢„æµ‹ç»“æžœè¿›è¡ŒåŽå¤„ç†ã€‚è¯¥æ–¹æ³•é¦–å…ˆä½¿ç”¨éžæžå¤§å€¼æŠ‘åˆ¶ï¼ˆNMSï¼‰æ¥è¿‡æ»¤æŽ‰é‡å çš„æ¡†ï¼Œç¡®ä¿åªä¿ç•™æœ€ç›¸å…³çš„é¢„æµ‹ã€‚ç”±äºŽSAMæ¨¡åž‹ä¸æ¶‰åŠç±»åˆ«é¢„æµ‹ï¼Œå› æ­¤åœ¨è°ƒç”¨NMSæ—¶ï¼Œç±»åˆ«æ•°è¢«è®¾ç½®ä¸º1ã€‚

æŽ¥ä¸‹æ¥ï¼Œæ–¹æ³•æž„å»ºäº†ä¸€ä¸ªå…¨æ¡†ï¼ˆ`full_box`ï¼‰ï¼Œå¹¶æ ¹æ®è¾“å…¥å›¾åƒçš„å°ºå¯¸è¿›è¡Œåˆå§‹åŒ–ã€‚ç„¶åŽï¼Œé€šè¿‡è®¡ç®—ä¸Žé¢„æµ‹æ¡†çš„IoUï¼ˆIntersection over Unionï¼‰æ¥ç¡®å®šå“ªäº›é¢„æµ‹æ¡†æ˜¯å…³é”®çš„ã€‚å¦‚æžœæœ‰æ»¡è¶³æ¡ä»¶çš„æ¡†ï¼Œ`full_box`çš„æŸäº›å€¼ä¼šè¢«æ›´æ–°ä¸ºé¢„æµ‹æ¡†çš„å€¼ã€‚

å¯¹äºŽè¾“å…¥çš„åŽŸå§‹å›¾åƒï¼Œå¦‚æžœå®ƒä¸æ˜¯åˆ—è¡¨æ ¼å¼ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸ºNumPyæ•°ç»„ã€‚æŽ¥ç€ï¼Œæ–¹æ³•ä¼šéåŽ†æ¯ä¸ªé¢„æµ‹æ¡†ï¼Œå¤„ç†ç›¸åº”çš„æŽ©è†œï¼Œå¹¶å°†ç»“æžœå­˜å‚¨åœ¨`results`åˆ—è¡¨ä¸­ã€‚æœ€ç»ˆï¼Œæ–¹æ³•è¿”å›žä¸€ä¸ªåŒ…å«å¤„ç†åŽç»“æžœçš„åˆ—è¡¨ï¼Œæ¯ä¸ªç»“æžœéƒ½åŒ…å«åŽŸå§‹å›¾åƒã€è·¯å¾„ã€æ¡†å’ŒæŽ©è†œç­‰ä¿¡æ¯ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¿™ä¸ªæ–‡ä»¶å®žçŽ°äº†å¿«é€ŸSAMåˆ†å‰²çš„é¢„æµ‹æµç¨‹ï¼Œç»“åˆäº†YOLOæ¡†æž¶çš„ä¼˜åŠ¿ï¼Œæä¾›äº†é«˜æ•ˆçš„å›¾åƒåˆ†å‰²èƒ½åŠ›ã€‚

#### 11.2 ui.py

```python
import sys
import subprocess

def run_script(script_path):
    """
    ä½¿ç”¨å½“å‰ Python çŽ¯å¢ƒè¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚

    Args:
        script_path (str): è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„

    Returns:
        None
    """
    # èŽ·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„
    python_path = sys.executable

    # æž„å»ºè¿è¡Œå‘½ä»¤
    command = f'"{python_path}" -m streamlit run "{script_path}"'

    # æ‰§è¡Œå‘½ä»¤
    result = subprocess.run(command, shell=True)
    if result.returncode != 0:
        print("è„šæœ¬è¿è¡Œå‡ºé”™ã€‚")


# å®žä¾‹åŒ–å¹¶è¿è¡Œåº”ç”¨
if __name__ == "__main__":
    # æŒ‡å®šæ‚¨çš„è„šæœ¬è·¯å¾„
    script_path = "web.py"  # è¿™é‡Œå¯ä»¥ç›´æŽ¥æŒ‡å®šè„šæœ¬è·¯å¾„

    # è¿è¡Œè„šæœ¬
    run_script(script_path)
```

### ä»£ç æ³¨é‡Šè¯´æ˜Žï¼š

1. **å¯¼å…¥æ¨¡å—**ï¼š
   - `import sys`ï¼šå¯¼å…¥ç³»ç»Ÿç›¸å…³çš„æ¨¡å—ï¼Œç”¨äºŽèŽ·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ã€‚
   - `import subprocess`ï¼šå¯¼å…¥å­è¿›ç¨‹æ¨¡å—ï¼Œç”¨äºŽæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚

2. **å®šä¹‰å‡½æ•° `run_script`**ï¼š
   - è¯¥å‡½æ•°æŽ¥æ”¶ä¸€ä¸ªå‚æ•° `script_path`ï¼Œè¡¨ç¤ºè¦è¿è¡Œçš„ Python è„šæœ¬çš„è·¯å¾„ã€‚
   - ä½¿ç”¨ `sys.executable` èŽ·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ï¼Œä»¥ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„ Python çŽ¯å¢ƒæ¥è¿è¡Œè„šæœ¬ã€‚
   - æž„å»ºä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸² `command`ï¼Œè¯¥å‘½ä»¤ä½¿ç”¨ `streamlit` æ¨¡å—è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚
   - ä½¿ç”¨ `subprocess.run` æ‰§è¡Œæž„å»ºçš„å‘½ä»¤ï¼Œå¹¶å°† `shell=True` ä¼ é€’ç»™å®ƒï¼Œä»¥ä¾¿åœ¨ shell ä¸­è¿è¡Œå‘½ä»¤ã€‚
   - æ£€æŸ¥å‘½ä»¤çš„è¿”å›žç ï¼Œå¦‚æžœä¸ä¸º 0ï¼Œè¡¨ç¤ºè„šæœ¬è¿è¡Œå‡ºé”™ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯ã€‚

3. **ä¸»ç¨‹åºå…¥å£**ï¼š
   - ä½¿ç”¨ `if __name__ == "__main__":` ç¡®ä¿è¯¥éƒ¨åˆ†ä»£ç ä»…åœ¨è„šæœ¬ç›´æŽ¥è¿è¡Œæ—¶æ‰§è¡Œã€‚
   - æŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ä¸º `web.py`ã€‚
   - è°ƒç”¨ `run_script` å‡½æ•°ï¼Œä¼ å…¥è„šæœ¬è·¯å¾„ä»¥æ‰§è¡Œè¯¥è„šæœ¬ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶åä¸º `ui.py`ï¼Œä¸»è¦åŠŸèƒ½æ˜¯é€šè¿‡å½“å‰çš„ Python çŽ¯å¢ƒè¿è¡Œä¸€ä¸ªæŒ‡å®šçš„è„šæœ¬ï¼Œå…·ä½“æ˜¯ä¸€ä¸ªåä¸º `web.py` çš„æ–‡ä»¶ã€‚ç¨‹åºé¦–å…ˆå¯¼å…¥äº†å¿…è¦çš„æ¨¡å—ï¼ŒåŒ…æ‹¬ `sys`ã€`os` å’Œ `subprocess`ï¼Œä»¥åŠä¸€ä¸ªè‡ªå®šä¹‰çš„ `abs_path` å‡½æ•°ï¼Œç”¨äºŽèŽ·å–æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚

åœ¨ `run_script` å‡½æ•°ä¸­ï¼Œç¨‹åºæŽ¥å—ä¸€ä¸ªå‚æ•° `script_path`ï¼Œè¿™æ˜¯è¦è¿è¡Œçš„è„šæœ¬çš„è·¯å¾„ã€‚å‡½æ•°é¦–å…ˆèŽ·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨ `python_path` å˜é‡ä¸­ã€‚æŽ¥ç€ï¼Œç¨‹åºæž„å»ºäº†ä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ï¼Œä½¿ç”¨ `streamlit` æ¨¡å—æ¥è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚å‘½ä»¤çš„æ ¼å¼æ˜¯ `"{python_path}" -m streamlit run "{script_path}"`ï¼Œè¿™æ„å‘³ç€å°†ä½¿ç”¨å½“å‰ Python è§£é‡Šå™¨æ¥æ‰§è¡Œ `streamlit` æ¨¡å—ï¼Œå¹¶è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚

éšåŽï¼Œç¨‹åºé€šè¿‡ `subprocess.run` æ–¹æ³•æ‰§è¡Œæž„å»ºå¥½çš„å‘½ä»¤ï¼Œå¹¶è®¾ç½® `shell=True` ä»¥ä¾¿åœ¨ shell ä¸­è¿è¡Œè¯¥å‘½ä»¤ã€‚æ‰§è¡Œå®Œå‘½ä»¤åŽï¼Œç¨‹åºæ£€æŸ¥è¿”å›žçš„ç»“æžœç ï¼Œå¦‚æžœç»“æžœç ä¸ä¸º 0ï¼Œè¡¨ç¤ºè„šæœ¬è¿è¡Œå‡ºé”™ï¼Œåˆ™æ‰“å°å‡ºç›¸åº”çš„é”™è¯¯ä¿¡æ¯ã€‚

åœ¨æ–‡ä»¶çš„æœ€åŽéƒ¨åˆ†ï¼Œç¨‹åºé€šè¿‡ `if __name__ == "__main__":` è¯­å¥æ¥ç¡®ä¿åªæœ‰åœ¨ç›´æŽ¥è¿è¡Œè¯¥æ–‡ä»¶æ—¶æ‰ä¼šæ‰§è¡ŒåŽé¢çš„ä»£ç ã€‚è¿™é‡ŒæŒ‡å®šäº†è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ä¸º `web.py`ï¼Œå¹¶è°ƒç”¨ `run_script` å‡½æ•°æ¥æ‰§è¡Œè¯¥è„šæœ¬ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªç¨‹åºçš„ä¸»è¦ä½œç”¨æ˜¯æä¾›ä¸€ä¸ªç®€å•çš„æŽ¥å£æ¥è¿è¡Œä¸€ä¸ª Streamlit åº”ç”¨è„šæœ¬ï¼Œå¹¶å¤„ç†å¯èƒ½å‡ºçŽ°çš„é”™è¯¯ã€‚

#### 11.3 code\ultralytics\models\sam\modules\__init__.py

å½“ç„¶å¯ä»¥ã€‚ä»¥ä¸‹æ˜¯å¯¹æ‚¨æä¾›çš„ä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†è¿›è¡Œæç‚¼å’Œè¯¦ç»†æ³¨é‡Šçš„ç¤ºä¾‹ï¼š

```python
# Ultralytics YOLO ðŸš€, AGPL-3.0 license

# å¯¼å…¥å¿…è¦çš„åº“
import torch  # å¯¼å…¥PyTorchåº“ï¼Œç”¨äºŽæ·±åº¦å­¦ä¹ æ¨¡åž‹çš„æž„å»ºå’Œè®­ç»ƒ

# å®šä¹‰YOLOæ¨¡åž‹ç±»
class YOLO:
    def __init__(self, model_path):
        # åˆå§‹åŒ–YOLOæ¨¡åž‹
        self.model = torch.load(model_path)  # åŠ è½½é¢„è®­ç»ƒçš„YOLOæ¨¡åž‹

    def predict(self, image):
        # å¯¹è¾“å…¥å›¾åƒè¿›è¡Œé¢„æµ‹
        with torch.no_grad():  # ç¦ç”¨æ¢¯åº¦è®¡ç®—ä»¥èŠ‚çœå†…å­˜
            predictions = self.model(image)  # ä½¿ç”¨æ¨¡åž‹å¯¹å›¾åƒè¿›è¡ŒæŽ¨ç†
        return predictions  # è¿”å›žé¢„æµ‹ç»“æžœ

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    yolo_model = YOLO('path/to/model.pt')  # åˆ›å»ºYOLOæ¨¡åž‹å®žä¾‹å¹¶åŠ è½½æ¨¡åž‹
    image = torch.randn(1, 3, 640, 640)  # åˆ›å»ºä¸€ä¸ªéšæœºå›¾åƒå¼ é‡ä½œä¸ºè¾“å…¥
    results = yolo_model.predict(image)  # è°ƒç”¨é¢„æµ‹æ–¹æ³•
    print(results)  # è¾“å‡ºé¢„æµ‹ç»“æžœ
```

### ä»£ç æ³¨é‡Šè¯´æ˜Žï¼š

1. **å¯¼å…¥åº“**ï¼šå¯¼å…¥`torch`åº“ï¼Œè¿™æ˜¯æ·±åº¦å­¦ä¹ ä¸­å¸¸ç”¨çš„åº“ï¼Œç”¨äºŽæž„å»ºå’Œè®­ç»ƒç¥žç»ç½‘ç»œã€‚

2. **YOLOç±»**ï¼šå®šä¹‰äº†ä¸€ä¸ªåä¸º`YOLO`çš„ç±»ï¼Œç”¨äºŽå°è£…YOLOæ¨¡åž‹çš„åŠŸèƒ½ã€‚

3. **åˆå§‹åŒ–æ–¹æ³•**ï¼šåœ¨`__init__`æ–¹æ³•ä¸­ï¼ŒåŠ è½½æŒ‡å®šè·¯å¾„çš„é¢„è®­ç»ƒYOLOæ¨¡åž‹ã€‚

4. **é¢„æµ‹æ–¹æ³•**ï¼š`predict`æ–¹æ³•æŽ¥å—ä¸€ä¸ªå›¾åƒä½œä¸ºè¾“å…¥ï¼Œä½¿ç”¨æ¨¡åž‹è¿›è¡ŒæŽ¨ç†ï¼Œå¹¶è¿”å›žé¢„æµ‹ç»“æžœã€‚ä½¿ç”¨`torch.no_grad()`æ¥ç¦ç”¨æ¢¯åº¦è®¡ç®—ï¼Œä»¥æé«˜æ€§èƒ½å’Œå‡å°‘å†…å­˜ä½¿ç”¨ã€‚

5. **ä½¿ç”¨ç¤ºä¾‹**ï¼šåœ¨ä¸»ç¨‹åºä¸­ï¼Œåˆ›å»ºYOLOæ¨¡åž‹çš„å®žä¾‹ï¼ŒåŠ è½½æ¨¡åž‹ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªéšæœºå›¾åƒè¿›è¡Œé¢„æµ‹ï¼Œæœ€åŽè¾“å‡ºé¢„æµ‹ç»“æžœã€‚

è¿™ä¸ªç®€åŒ–ç‰ˆæœ¬çš„ä»£ç ä¿ç•™äº†YOLOæ¨¡åž‹çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå¹¶æ·»åŠ äº†è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šä»¥å¸®åŠ©ç†è§£ã€‚

è¿™ä¸ªæ–‡ä»¶æ˜¯Ultralytics YOLOé¡¹ç›®çš„ä¸€éƒ¨åˆ†ï¼Œæ–‡ä»¶åä¸º`__init__.py`ï¼Œé€šå¸¸ç”¨äºŽå°†ä¸€ä¸ªç›®å½•æ ‡è¯†ä¸ºPythonåŒ…ã€‚æ–‡ä»¶çš„å¼€å¤´åŒ…å«äº†ä¸€è¡Œæ³¨é‡Šï¼Œè¡¨æ˜Žè¯¥é¡¹ç›®æ˜¯Ultralytics YOLOçš„å®žçŽ°ï¼Œå¹¶ä¸”ä½¿ç”¨AGPL-3.0è®¸å¯è¯ã€‚

AGPL-3.0è®¸å¯è¯æ˜¯ä¸€ç§å¼€æºè®¸å¯è¯ï¼Œå…è®¸ç”¨æˆ·è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†å‘è½¯ä»¶ï¼Œä½†è¦æ±‚åœ¨åˆ†å‘ä¿®æ”¹åŽçš„ç‰ˆæœ¬æ—¶ï¼Œå¿…é¡»æä¾›æºä»£ç ï¼Œå¹¶ä¸”åœ¨ç½‘ç»œä¸Šæä¾›æœåŠ¡æ—¶ä¹Ÿå¿…é¡»å…¬å¼€æºä»£ç ã€‚è¿™ç§è®¸å¯è¯æ—¨åœ¨ç¡®ä¿è½¯ä»¶çš„è‡ªç”±ä½¿ç”¨å’Œå…±äº«ã€‚

åœ¨`__init__.py`æ–‡ä»¶ä¸­ï¼Œé€šå¸¸ä¼šåŒ…å«ä¸€äº›åˆå§‹åŒ–ä»£ç ï¼Œæˆ–è€…å®šä¹‰è¯¥åŒ…çš„å…¬å…±æŽ¥å£ï¼Œæ¯”å¦‚å¯¼å…¥å…¶ä»–æ¨¡å—æˆ–å®šä¹‰ä¸€äº›å¸¸é‡å’Œå‡½æ•°ã€‚å°½ç®¡åœ¨è¿™ä¸ªç‰‡æ®µä¸­æ²¡æœ‰æ˜¾ç¤ºå…·ä½“çš„å®žçŽ°ç»†èŠ‚ï¼Œä½†å¯ä»¥æŽ¨æµ‹ï¼Œè¿™ä¸ªæ–‡ä»¶å¯èƒ½ä¼šè´Ÿè´£åˆå§‹åŒ–ä¸ŽYOLOæ¨¡åž‹ç›¸å…³çš„æ¨¡å—ï¼Œç¡®ä¿ç”¨æˆ·åœ¨å¯¼å…¥è¯¥åŒ…æ—¶èƒ½å¤Ÿæ–¹ä¾¿åœ°è®¿é—®æ‰€éœ€çš„åŠŸèƒ½ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯Ultralytics YOLOé¡¹ç›®ç»“æž„ä¸­çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼Œç¡®ä¿äº†åŒ…çš„æ­£ç¡®æ€§å’Œå¯ç”¨æ€§ï¼ŒåŒæ—¶éµå¾ªå¼€æºåè®®ï¼Œä¿ƒè¿›äº†ä»£ç çš„å…±äº«ä¸Žåˆä½œã€‚

#### 11.4 code\ultralytics\models\sam\model.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
from pathlib import Path
from ultralytics.engine.model import Model
from .build import build_sam
from .predict import Predictor

class SAM(Model):
    """
    SAM (Segment Anything Model) æŽ¥å£ç±»ã€‚

    SAM æ—¨åœ¨å®žçŽ°å¯æç¤ºçš„å®žæ—¶å›¾åƒåˆ†å‰²ã€‚å¯ä»¥ä½¿ç”¨å¤šç§æç¤ºæ–¹å¼ï¼Œå¦‚è¾¹ç•Œæ¡†ã€ç‚¹æˆ–æ ‡ç­¾ã€‚è¯¥æ¨¡åž‹å…·æœ‰é›¶-shot æ€§èƒ½ï¼Œå¹¶åœ¨ SA-1B æ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒã€‚
    """

    def __init__(self, model="sam_b.pt") -> None:
        """
        ä½¿ç”¨é¢„è®­ç»ƒæ¨¡åž‹æ–‡ä»¶åˆå§‹åŒ– SAM æ¨¡åž‹ã€‚

        å‚æ•°:
            model (str): é¢„è®­ç»ƒ SAM æ¨¡åž‹æ–‡ä»¶çš„è·¯å¾„ã€‚æ–‡ä»¶åº”å…·æœ‰ .pt æˆ– .pth æ‰©å±•åã€‚

        å¼‚å¸¸:
            NotImplementedError: å¦‚æžœæ¨¡åž‹æ–‡ä»¶æ‰©å±•åä¸æ˜¯ .pt æˆ– .pthã€‚
        """
        # æ£€æŸ¥æ¨¡åž‹æ–‡ä»¶çš„æ‰©å±•åæ˜¯å¦ä¸º .pt æˆ– .pth
        if model and Path(model).suffix not in (".pt", ".pth"):
            raise NotImplementedError("SAM é¢„æµ‹éœ€è¦é¢„è®­ç»ƒçš„ *.pt æˆ– *.pth æ¨¡åž‹ã€‚")
        # è°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–æ–¹æ³•
        super().__init__(model=model, task="segment")

    def predict(self, source, stream=False, bboxes=None, points=None, labels=None, **kwargs):
        """
        å¯¹ç»™å®šçš„å›¾åƒæˆ–è§†é¢‘æºæ‰§è¡Œåˆ†å‰²é¢„æµ‹ã€‚

        å‚æ•°:
            source (str): å›¾åƒæˆ–è§†é¢‘æ–‡ä»¶çš„è·¯å¾„ï¼Œæˆ– PIL.Image å¯¹è±¡ï¼Œæˆ– numpy.ndarray å¯¹è±¡ã€‚
            stream (bool, optional): å¦‚æžœä¸º Trueï¼Œåˆ™å¯ç”¨å®žæ—¶æµã€‚é»˜è®¤ä¸º Falseã€‚
            bboxes (list, optional): ç”¨äºŽæç¤ºåˆ†å‰²çš„è¾¹ç•Œæ¡†åæ ‡åˆ—è¡¨ã€‚é»˜è®¤ä¸º Noneã€‚
            points (list, optional): ç”¨äºŽæç¤ºåˆ†å‰²çš„ç‚¹åˆ—è¡¨ã€‚é»˜è®¤ä¸º Noneã€‚
            labels (list, optional): ç”¨äºŽæç¤ºåˆ†å‰²çš„æ ‡ç­¾åˆ—è¡¨ã€‚é»˜è®¤ä¸º Noneã€‚

        è¿”å›ž:
            (list): æ¨¡åž‹çš„é¢„æµ‹ç»“æžœã€‚
        """
        # è®¾ç½®é¢„æµ‹çš„é»˜è®¤å‚æ•°
        overrides = dict(conf=0.25, task="segment", mode="predict", imgsz=1024)
        kwargs.update(overrides)  # æ›´æ–°é¢å¤–å‚æ•°
        prompts = dict(bboxes=bboxes, points=points, labels=labels)  # æ”¶é›†æç¤ºä¿¡æ¯
        # è°ƒç”¨çˆ¶ç±»çš„é¢„æµ‹æ–¹æ³•
        return super().predict(source, stream, prompts=prompts, **kwargs)

    def info(self, detailed=False, verbose=True):
        """
        è®°å½•æœ‰å…³ SAM æ¨¡åž‹çš„ä¿¡æ¯ã€‚

        å‚æ•°:
            detailed (bool, optional): å¦‚æžœä¸º Trueï¼Œåˆ™æ˜¾ç¤ºæœ‰å…³æ¨¡åž‹çš„è¯¦ç»†ä¿¡æ¯ã€‚é»˜è®¤ä¸º Falseã€‚
            verbose (bool, optional): å¦‚æžœä¸º Trueï¼Œåˆ™åœ¨æŽ§åˆ¶å°ä¸Šæ˜¾ç¤ºä¿¡æ¯ã€‚é»˜è®¤ä¸º Trueã€‚

        è¿”å›ž:
            (tuple): åŒ…å«æ¨¡åž‹ä¿¡æ¯çš„å…ƒç»„ã€‚
        """
        return model_info(self.model, detailed=detailed, verbose=verbose)

    @property
    def task_map(self):
        """
        æä¾›ä»Ž 'segment' ä»»åŠ¡åˆ°å…¶å¯¹åº”çš„ 'Predictor' çš„æ˜ å°„ã€‚

        è¿”å›ž:
            (dict): å°† 'segment' ä»»åŠ¡æ˜ å°„åˆ°å…¶å¯¹åº”çš„ 'Predictor' çš„å­—å…¸ã€‚
        """
        return {"segment": {"predictor": Predictor}}
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è§£é‡Šï¼š
1. **ç±»å®šä¹‰**ï¼š`SAM` ç±»ç»§æ‰¿è‡ª `Model`ï¼Œç”¨äºŽå®žçŽ°å¯æç¤ºçš„å®žæ—¶å›¾åƒåˆ†å‰²åŠŸèƒ½ã€‚
2. **åˆå§‹åŒ–æ–¹æ³•**ï¼š`__init__` æ–¹æ³•ç”¨äºŽåŠ è½½é¢„è®­ç»ƒæ¨¡åž‹ï¼Œç¡®ä¿æ¨¡åž‹æ–‡ä»¶å…·æœ‰æ­£ç¡®çš„æ‰©å±•åã€‚
3. **é¢„æµ‹æ–¹æ³•**ï¼š`predict` æ–¹æ³•ç”¨äºŽå¯¹è¾“å…¥çš„å›¾åƒæˆ–è§†é¢‘æºè¿›è¡Œåˆ†å‰²é¢„æµ‹ï¼Œæ”¯æŒå¤šç§æç¤ºæ–¹å¼ï¼ˆè¾¹ç•Œæ¡†ã€ç‚¹ã€æ ‡ç­¾ï¼‰ã€‚
4. **ä¿¡æ¯æ–¹æ³•**ï¼š`info` æ–¹æ³•ç”¨äºŽèŽ·å–æ¨¡åž‹çš„ç›¸å…³ä¿¡æ¯ï¼Œå¯ä»¥é€‰æ‹©è¯¦ç»†ç¨‹åº¦å’Œè¾“å‡ºæ–¹å¼ã€‚
5. **ä»»åŠ¡æ˜ å°„**ï¼š`task_map` å±žæ€§æä¾›äº†ä»»åŠ¡åˆ°é¢„æµ‹å™¨çš„æ˜ å°„ï¼Œä¾¿äºŽåŽç»­çš„ä»»åŠ¡å¤„ç†ã€‚

è¯¥ç¨‹åºæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º `SAM` çš„ç±»ï¼Œæ—¨åœ¨ä¸º Ultralytics çš„ Segment Anything Model (SAM) æä¾›æŽ¥å£ï¼Œä¸»è¦ç”¨äºŽå®žæ—¶å›¾åƒåˆ†å‰²ä»»åŠ¡ã€‚SAM æ¨¡åž‹å…·å¤‡çµæ´»çš„æç¤ºå¼åˆ†å‰²èƒ½åŠ›ï¼Œèƒ½å¤Ÿåœ¨æ²¡æœ‰å…ˆå‰çŸ¥è¯†çš„æƒ…å†µä¸‹é€‚åº”æ–°çš„å›¾åƒåˆ†å¸ƒå’Œä»»åŠ¡ï¼Œå…·æœ‰é›¶-shot æ€§èƒ½ã€‚è¯¥æ¨¡åž‹ç»è¿‡ SA-1B æ•°æ®é›†çš„è®­ç»ƒï¼Œèƒ½å¤Ÿå¤„ç†å¤šç§è¾“å…¥æç¤ºï¼Œå¦‚è¾¹ç•Œæ¡†ã€ç‚¹æˆ–æ ‡ç­¾ã€‚

åœ¨æ–‡ä»¶å¼€å¤´ï¼Œé¦–å…ˆå¯¼å…¥äº†å¿…è¦çš„æ¨¡å—å’Œç±»ï¼ŒåŒ…æ‹¬ `Path`ã€`Model`ã€`model_info`ã€`build_sam` å’Œ `Predictor`ã€‚æŽ¥ç€ï¼Œå®šä¹‰äº† `SAM` ç±»ï¼Œè¯¥ç±»ç»§æ‰¿è‡ª `Model` ç±»ã€‚

`SAM` ç±»çš„æž„é€ å‡½æ•° `__init__` æŽ¥å—ä¸€ä¸ªå‚æ•° `model`ï¼Œç”¨äºŽæŒ‡å®šé¢„è®­ç»ƒæ¨¡åž‹æ–‡ä»¶çš„è·¯å¾„ã€‚è¯¥æ–‡ä»¶åº”ä»¥ `.pt` æˆ– `.pth` ä¸ºåŽç¼€ã€‚å¦‚æžœæä¾›çš„æ¨¡åž‹æ–‡ä»¶è·¯å¾„ä¸ç¬¦åˆè¦æ±‚ï¼Œåˆ™ä¼šæŠ›å‡º `NotImplementedError` å¼‚å¸¸ã€‚æž„é€ å‡½æ•°ä¸­è°ƒç”¨äº†çˆ¶ç±»çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œå¹¶æŒ‡å®šä»»åŠ¡ä¸ºâ€œåˆ†å‰²â€ã€‚

ç±»ä¸­å®šä¹‰äº† `_load` æ–¹æ³•ï¼Œç”¨äºŽåŠ è½½æŒ‡å®šçš„æƒé‡æ–‡ä»¶åˆ° SAM æ¨¡åž‹ä¸­ã€‚è¯¥æ–¹æ³•æŽ¥å—æƒé‡æ–‡ä»¶çš„è·¯å¾„å’Œå¯é€‰çš„ä»»åŠ¡åç§°ä½œä¸ºå‚æ•°ã€‚

`predict` æ–¹æ³•ç”¨äºŽå¯¹ç»™å®šçš„å›¾åƒæˆ–è§†é¢‘æºè¿›è¡Œåˆ†å‰²é¢„æµ‹ã€‚å®ƒæŽ¥å—å¤šä¸ªå‚æ•°ï¼ŒåŒ…æ‹¬æºæ–‡ä»¶è·¯å¾„ã€æ˜¯å¦å¯ç”¨å®žæ—¶æµã€è¾¹ç•Œæ¡†ã€ç‚¹å’Œæ ‡ç­¾ç­‰ã€‚è¯¥æ–¹æ³•ä¼šå°†ä¸€äº›é»˜è®¤å‚æ•°ï¼ˆå¦‚ç½®ä¿¡åº¦ã€ä»»åŠ¡ç±»åž‹å’Œå›¾åƒå¤§å°ï¼‰åˆå¹¶åˆ° `kwargs` ä¸­ï¼Œå¹¶å°†æç¤ºä¿¡æ¯æ‰“åŒ…æˆå­—å…¸ï¼Œç„¶åŽè°ƒç”¨çˆ¶ç±»çš„ `predict` æ–¹æ³•è¿›è¡Œé¢„æµ‹ã€‚

`__call__` æ–¹æ³•æ˜¯ `predict` æ–¹æ³•çš„åˆ«åï¼Œæä¾›äº†ç›¸åŒçš„åŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·ä»¥æ›´ç®€æ´çš„æ–¹å¼è°ƒç”¨æ¨¡åž‹ã€‚

`info` æ–¹æ³•ç”¨äºŽè®°å½• SAM æ¨¡åž‹çš„ä¿¡æ¯ã€‚å®ƒæŽ¥å—ä¸¤ä¸ªå¯é€‰å‚æ•°ï¼Œ`detailed` ç”¨äºŽæŽ§åˆ¶æ˜¯å¦æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼Œ`verbose` ç”¨äºŽæŽ§åˆ¶æ˜¯å¦åœ¨æŽ§åˆ¶å°è¾“å‡ºä¿¡æ¯ã€‚è¯¥æ–¹æ³•è¿”å›žä¸€ä¸ªåŒ…å«æ¨¡åž‹ä¿¡æ¯çš„å…ƒç»„ã€‚

æœ€åŽï¼Œ`task_map` å±žæ€§æä¾›äº†ä¸€ä¸ªå­—å…¸ï¼Œå°†â€œåˆ†å‰²â€ä»»åŠ¡æ˜ å°„åˆ°ç›¸åº”çš„ `Predictor`ã€‚è¿™ä¸ªæ˜ å°„å¯ä»¥å¸®åŠ©ç”¨æˆ·å¿«é€Ÿæ‰¾åˆ°ä¸Žç‰¹å®šä»»åŠ¡ç›¸å…³çš„é¢„æµ‹å™¨ã€‚

æ•´ä½“è€Œè¨€ï¼Œè¯¥æ–‡ä»¶å®žçŽ°äº†ä¸€ä¸ªçµæ´»ä¸”åŠŸèƒ½å¼ºå¤§çš„å›¾åƒåˆ†å‰²æ¨¡åž‹æŽ¥å£ï¼Œæ”¯æŒå¤šç§è¾“å…¥æ–¹å¼å’Œå®žæ—¶å¤„ç†èƒ½åŠ›ï¼Œé€‚åˆäºŽå„ç§å›¾åƒåˆ†æžä»»åŠ¡ã€‚

#### 11.5 train.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼š

```python
import random
import numpy as np
import torch.nn as nn
from ultralytics.data import build_dataloader, build_yolo_dataset
from ultralytics.engine.trainer import BaseTrainer
from ultralytics.models import yolo
from ultralytics.nn.tasks import DetectionModel
from ultralytics.utils import LOGGER, RANK
from ultralytics.utils.torch_utils import de_parallel, torch_distributed_zero_first

class DetectionTrainer(BaseTrainer):
    """
    æ‰©å±•è‡ª BaseTrainer ç±»ï¼Œç”¨äºŽåŸºäºŽæ£€æµ‹æ¨¡åž‹çš„è®­ç»ƒã€‚
    """

    def build_dataset(self, img_path, mode="train", batch=None):
        """
        æž„å»º YOLO æ•°æ®é›†ã€‚

        å‚æ•°:
            img_path (str): åŒ…å«å›¾åƒçš„æ–‡ä»¶å¤¹è·¯å¾„ã€‚
            mode (str): æ¨¡å¼ï¼Œå¯ä»¥æ˜¯ 'train' æˆ– 'val'ï¼Œç”¨äºŽä¸åŒçš„æ•°æ®å¢žå¼ºã€‚
            batch (int, optional): æ‰¹é‡å¤§å°ï¼Œä»…ç”¨äºŽ 'rect' æ¨¡å¼ã€‚é»˜è®¤ä¸º Noneã€‚
        """
        gs = max(int(de_parallel(self.model).stride.max() if self.model else 0), 32)
        return build_yolo_dataset(self.args, img_path, batch, self.data, mode=mode, rect=mode == "val", stride=gs)

    def get_dataloader(self, dataset_path, batch_size=16, rank=0, mode="train"):
        """æž„é€ å¹¶è¿”å›žæ•°æ®åŠ è½½å™¨ã€‚"""
        assert mode in ["train", "val"]
        with torch_distributed_zero_first(rank):  # åœ¨ DDP æ¨¡å¼ä¸‹ï¼Œä»…åˆå§‹åŒ–ä¸€æ¬¡æ•°æ®é›†
            dataset = self.build_dataset(dataset_path, mode, batch_size)
        shuffle = mode == "train"  # è®­ç»ƒæ¨¡å¼ä¸‹æ‰“ä¹±æ•°æ®
        workers = self.args.workers if mode == "train" else self.args.workers * 2
        return build_dataloader(dataset, batch_size, workers, shuffle, rank)  # è¿”å›žæ•°æ®åŠ è½½å™¨

    def preprocess_batch(self, batch):
        """å¯¹å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬ç¼©æ”¾å’Œè½¬æ¢ä¸ºæµ®ç‚¹æ•°ã€‚"""
        batch["img"] = batch["img"].to(self.device, non_blocking=True).float() / 255  # å°†å›¾åƒè½¬æ¢ä¸ºæµ®ç‚¹æ•°å¹¶å½’ä¸€åŒ–
        if self.args.multi_scale:  # å¦‚æžœå¯ç”¨å¤šå°ºåº¦
            imgs = batch["img"]
            sz = (
                random.randrange(self.args.imgsz * 0.5, self.args.imgsz * 1.5 + self.stride)
                // self.stride
                * self.stride
            )  # éšæœºé€‰æ‹©æ–°çš„å°ºå¯¸
            sf = sz / max(imgs.shape[2:])  # è®¡ç®—ç¼©æ”¾å› å­
            if sf != 1:
                ns = [
                    math.ceil(x * sf / self.stride) * self.stride for x in imgs.shape[2:]
                ]  # è®¡ç®—æ–°çš„å½¢çŠ¶
                imgs = nn.functional.interpolate(imgs, size=ns, mode="bilinear", align_corners=False)  # è¿›è¡Œæ’å€¼
            batch["img"] = imgs
        return batch

    def set_model_attributes(self):
        """è®¾ç½®æ¨¡åž‹çš„å±žæ€§ï¼ŒåŒ…æ‹¬ç±»åˆ«æ•°é‡å’Œåç§°ã€‚"""
        self.model.nc = self.data["nc"]  # å°†ç±»åˆ«æ•°é‡é™„åŠ åˆ°æ¨¡åž‹
        self.model.names = self.data["names"]  # å°†ç±»åˆ«åç§°é™„åŠ åˆ°æ¨¡åž‹
        self.model.args = self.args  # å°†è¶…å‚æ•°é™„åŠ åˆ°æ¨¡åž‹

    def get_model(self, cfg=None, weights=None, verbose=True):
        """è¿”å›ž YOLO æ£€æµ‹æ¨¡åž‹ã€‚"""
        model = DetectionModel(cfg, nc=self.data["nc"], verbose=verbose and RANK == -1)
        if weights:
            model.load(weights)  # åŠ è½½æƒé‡
        return model

    def plot_training_samples(self, batch, ni):
        """ç»˜åˆ¶å¸¦æœ‰æ³¨é‡Šçš„è®­ç»ƒæ ·æœ¬ã€‚"""
        plot_images(
            images=batch["img"],
            batch_idx=batch["batch_idx"],
            cls=batch["cls"].squeeze(-1),
            bboxes=batch["bboxes"],
            paths=batch["im_file"],
            fname=self.save_dir / f"train_batch{ni}.jpg",
            on_plot=self.on_plot,
        )
```

### ä»£ç è¯´æ˜Žï¼š
1. **å¯¼å…¥æ¨¡å—**ï¼šå¯¼å…¥å¿…è¦çš„åº“å’Œæ¨¡å—ä»¥æ”¯æŒæ•°æ®å¤„ç†ã€æ¨¡åž‹æž„å»ºå’Œè®­ç»ƒã€‚
2. **DetectionTrainer ç±»**ï¼šç»§æ‰¿è‡ª `BaseTrainer`ï¼Œç”¨äºŽå®žçŽ° YOLO æ¨¡åž‹çš„è®­ç»ƒã€‚
3. **build_dataset æ–¹æ³•**ï¼šæ ¹æ®è¾“å…¥çš„å›¾åƒè·¯å¾„å’Œæ¨¡å¼æž„å»º YOLO æ•°æ®é›†ï¼Œæ”¯æŒè®­ç»ƒå’ŒéªŒè¯æ¨¡å¼ã€‚
4. **get_dataloader æ–¹æ³•**ï¼šæž„é€ æ•°æ®åŠ è½½å™¨ï¼Œå¤„ç†æ•°æ®é›†çš„åˆå§‹åŒ–å’Œæ‰“ä¹±è®¾ç½®ã€‚
5. **preprocess_batch æ–¹æ³•**ï¼šå¯¹è¾“å…¥çš„å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å½’ä¸€åŒ–å’Œå¤šå°ºåº¦è°ƒæ•´ã€‚
6. **set_model_attributes æ–¹æ³•**ï¼šè®¾ç½®æ¨¡åž‹çš„ç±»åˆ«æ•°é‡å’Œåç§°ï¼Œä»¥ä¾¿äºŽè®­ç»ƒæ—¶ä½¿ç”¨ã€‚
7. **get_model æ–¹æ³•**ï¼šè¿”å›žä¸€ä¸ª YOLO æ£€æµ‹æ¨¡åž‹ï¼Œå¹¶å¯é€‰æ‹©æ€§åœ°åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚
8. **plot_training_samples æ–¹æ³•**ï¼šç»˜åˆ¶è®­ç»ƒæ ·æœ¬åŠå…¶æ³¨é‡Šï¼Œä¾¿äºŽå¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ•°æ®ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `train.py` æ˜¯ä¸€ä¸ªç”¨äºŽè®­ç»ƒ YOLOï¼ˆYou Only Look Onceï¼‰ç›®æ ‡æ£€æµ‹æ¨¡åž‹çš„ Python è„šæœ¬ï¼Œå±žäºŽ Ultralytics YOLO é¡¹ç›®çš„ä¸€éƒ¨åˆ†ã€‚è¯¥æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º `DetectionTrainer` çš„ç±»ï¼Œç»§æ‰¿è‡ª `BaseTrainer`ï¼Œç”¨äºŽå¤„ç†ä¸Žç›®æ ‡æ£€æµ‹ç›¸å…³çš„è®­ç»ƒä»»åŠ¡ã€‚

åœ¨è¿™ä¸ªç±»ä¸­ï¼Œé¦–å…ˆå®šä¹‰äº†ä¸€ä¸ªæž„é€ æ•°æ®é›†çš„æ–¹æ³• `build_dataset`ï¼Œå®ƒæŽ¥å—å›¾åƒè·¯å¾„ã€æ¨¡å¼ï¼ˆè®­ç»ƒæˆ–éªŒè¯ï¼‰å’Œæ‰¹é‡å¤§å°ä½œä¸ºå‚æ•°ã€‚è¯¥æ–¹æ³•ä¼šæ ¹æ®æ¨¡åž‹çš„æ­¥å¹…ï¼ˆstrideï¼‰æž„å»º YOLO æ•°æ®é›†ï¼Œå¹¶å…è®¸ç”¨æˆ·ä¸ºä¸åŒçš„æ¨¡å¼è‡ªå®šä¹‰æ•°æ®å¢žå¼ºã€‚

æŽ¥ä¸‹æ¥ï¼Œ`get_dataloader` æ–¹æ³•ç”¨äºŽæž„å»ºå¹¶è¿”å›žæ•°æ®åŠ è½½å™¨ã€‚å®ƒä¼šæ ¹æ®æ¨¡å¼ï¼ˆè®­ç»ƒæˆ–éªŒè¯ï¼‰æ¥å†³å®šæ˜¯å¦æ‰“ä¹±æ•°æ®ï¼Œå¹¶æ ¹æ®éœ€è¦åˆå§‹åŒ–æ•°æ®é›†ã€‚æ­¤æ–¹æ³•è¿˜ä¼šè€ƒè™‘åˆ†å¸ƒå¼è®­ç»ƒçš„æƒ…å†µï¼Œç¡®ä¿æ•°æ®é›†åªåˆå§‹åŒ–ä¸€æ¬¡ã€‚

`preprocess_batch` æ–¹æ³•ç”¨äºŽå¯¹ä¸€æ‰¹å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬ç¼©æ”¾å’Œè½¬æ¢ä¸ºæµ®ç‚¹æ•°ã€‚å®ƒä¼šæ ¹æ®è®¾å®šçš„å¤šå°ºåº¦ç­–ç•¥è°ƒæ•´å›¾åƒçš„å¤§å°ï¼Œä»¥é€‚åº”æ¨¡åž‹çš„è¾“å…¥è¦æ±‚ã€‚

`set_model_attributes` æ–¹æ³•ç”¨äºŽè®¾ç½®æ¨¡åž‹çš„å±žæ€§ï¼ŒåŒ…æ‹¬ç±»åˆ«æ•°é‡å’Œç±»åˆ«åç§°ç­‰ã€‚è¿™äº›å±žæ€§ä¼šå½±å“æ¨¡åž‹çš„è®­ç»ƒå’ŒæŽ¨ç†è¿‡ç¨‹ã€‚

`get_model` æ–¹æ³•ç”¨äºŽè¿”å›žä¸€ä¸ª YOLO æ£€æµ‹æ¨¡åž‹å®žä¾‹ï¼Œå¹¶å¯é€‰æ‹©åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚`get_validator` æ–¹æ³•åˆ™è¿”å›žä¸€ä¸ªç”¨äºŽæ¨¡åž‹éªŒè¯çš„éªŒè¯å™¨ã€‚

`label_loss_items` æ–¹æ³•ç”¨äºŽè¿”å›žå¸¦æœ‰æ ‡ç­¾çš„è®­ç»ƒæŸå¤±é¡¹å­—å…¸ï¼Œä¾¿äºŽåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è·Ÿè¸ªæŸå¤±æƒ…å†µã€‚`progress_string` æ–¹æ³•è¿”å›žä¸€ä¸ªæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ï¼Œæ˜¾ç¤ºè®­ç»ƒè¿›åº¦ï¼ŒåŒ…æ‹¬å½“å‰çš„ epochã€GPU å†…å­˜ä½¿ç”¨æƒ…å†µã€æŸå¤±å€¼ã€å®žä¾‹æ•°é‡å’Œå›¾åƒå¤§å°ç­‰ä¿¡æ¯ã€‚

æ­¤å¤–ï¼Œ`plot_training_samples` æ–¹æ³•ç”¨äºŽç»˜åˆ¶è®­ç»ƒæ ·æœ¬åŠå…¶æ³¨é‡Šï¼Œæ–¹ä¾¿å¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ•°æ®ã€‚`plot_metrics` å’Œ `plot_training_labels` æ–¹æ³•åˆ™ç”¨äºŽç»˜åˆ¶è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŒ‡æ ‡å’Œæ ‡ç­¾ï¼Œå¸®åŠ©ç”¨æˆ·åˆ†æžæ¨¡åž‹çš„æ€§èƒ½ã€‚

æ€»ä½“æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶æä¾›äº†ä¸€ä¸ªç»“æž„åŒ–çš„æ–¹å¼æ¥è®­ç»ƒ YOLO æ¨¡åž‹ï¼Œæ¶µç›–äº†æ•°æ®é›†æž„å»ºã€æ•°æ®åŠ è½½ã€æ¨¡åž‹è®¾ç½®ã€æŸå¤±è·Ÿè¸ªå’Œç»“æžœå¯è§†åŒ–ç­‰å¤šä¸ªæ–¹é¢ï¼Œé€‚åˆç”¨äºŽç›®æ ‡æ£€æµ‹ä»»åŠ¡çš„è®­ç»ƒå’Œè¯„ä¼°ã€‚

#### 11.6 code\ultralytics\data\explorer\explorer.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
class Explorer:
    def __init__(self, data: Union[str, Path] = "coco128.yaml", model: str = "yolov8n.pt", uri: str = "~/ultralytics/explorer") -> None:
        # åˆå§‹åŒ–Explorerç±»ï¼Œè®¾ç½®æ•°æ®é›†è·¯å¾„ã€æ¨¡åž‹è·¯å¾„å’Œæ•°æ®åº“è¿žæŽ¥URI
        checks.check_requirements(["lancedb>=0.4.3", "duckdb"])  # æ£€æŸ¥ä¾èµ–åº“æ˜¯å¦æ»¡è¶³è¦æ±‚
        import lancedb  # å¯¼å…¥lancedbåº“ä»¥è¿›è¡Œæ•°æ®åº“æ“ä½œ

        self.connection = lancedb.connect(uri)  # è¿žæŽ¥åˆ°LanceDBæ•°æ®åº“
        self.table_name = Path(data).name.lower() + "_" + model.lower()  # ç”Ÿæˆè¡¨å
        self.sim_idx_base_name = f"{self.table_name}_sim_idx".lower()  # ç”Ÿæˆç›¸ä¼¼æ€§ç´¢å¼•çš„åŸºç¡€åç§°
        self.model = YOLO(model)  # åŠ è½½YOLOæ¨¡åž‹
        self.data = data  # æ•°æ®é›†è·¯å¾„
        self.choice_set = None  # é€‰æ‹©çš„æ•°æ®é›†

        self.table = None  # æ•°æ®åº“è¡¨
        self.progress = 0  # è¿›åº¦

    def create_embeddings_table(self, force: bool = False, split: str = "train") -> None:
        """
        åˆ›å»ºä¸€ä¸ªLanceDBè¡¨ï¼ŒåŒ…å«æ•°æ®é›†ä¸­å›¾åƒçš„åµŒå…¥ã€‚å¦‚æžœè¡¨å·²å­˜åœ¨ï¼Œåˆ™é‡ç”¨è¯¥è¡¨ã€‚
        å‚æ•°:
            force (bool): æ˜¯å¦è¦†ç›–çŽ°æœ‰è¡¨ã€‚é»˜è®¤ä¸ºFalseã€‚
            split (str): ä½¿ç”¨çš„æ•°æ®é›†åˆ’åˆ†ã€‚é»˜è®¤ä¸º'train'ã€‚
        """
        if self.table is not None and not force:
            LOGGER.info("Table already exists. Reusing it. Pass force=True to overwrite it.")
            return
        if self.table_name in self.connection.table_names() and not force:
            LOGGER.info(f"Table {self.table_name} already exists. Reusing it. Pass force=True to overwrite it.")
            self.table = self.connection.open_table(self.table_name)
            self.progress = 1
            return
        if self.data is None:
            raise ValueError("Data must be provided to create embeddings table")

        data_info = check_det_dataset(self.data)  # æ£€æŸ¥æ•°æ®é›†ä¿¡æ¯
        if split not in data_info:
            raise ValueError(f"Split {split} is not found in the dataset. Available keys in the dataset are {list(data_info.keys())}")

        choice_set = data_info[split]  # èŽ·å–æŒ‡å®šåˆ’åˆ†çš„æ•°æ®é›†
        choice_set = choice_set if isinstance(choice_set, list) else [choice_set]
        self.choice_set = choice_set
        dataset = ExplorerDataset(img_path=choice_set, data=data_info, augment=False, cache=False, task=self.model.task)  # åˆ›å»ºæ•°æ®é›†å®žä¾‹

        # åˆ›å»ºè¡¨çš„æ¨¡å¼
        batch = dataset[0]  # èŽ·å–ä¸€ä¸ªæ‰¹æ¬¡çš„æ•°æ®
        vector_size = self.model.embed(batch["im_file"], verbose=False)[0].shape[0]  # èŽ·å–åµŒå…¥å‘é‡çš„ç»´åº¦
        table = self.connection.create_table(self.table_name, schema=get_table_schema(vector_size), mode="overwrite")  # åˆ›å»ºè¡¨
        table.add(self._yield_batches(dataset, data_info, self.model, exclude_keys=["img", "ratio_pad", "resized_shape", "ori_shape", "batch_idx"]))  # æ·»åŠ æ•°æ®åˆ°è¡¨ä¸­

        self.table = table  # ä¿å­˜è¡¨çš„å¼•ç”¨

    def query(self, imgs: Union[str, np.ndarray, List[str], List[np.ndarray]] = None, limit: int = 25) -> Any:
        """
        æŸ¥è¯¢è¡¨ä»¥èŽ·å–ç›¸ä¼¼å›¾åƒã€‚æŽ¥å—å•ä¸ªå›¾åƒæˆ–å›¾åƒåˆ—è¡¨ã€‚
        å‚æ•°:
            imgs (str or list): å›¾åƒè·¯å¾„æˆ–å›¾åƒè·¯å¾„åˆ—è¡¨ã€‚
            limit (int): è¿”å›žçš„ç»“æžœæ•°é‡ã€‚
        è¿”å›ž:
            (pyarrow.Table): åŒ…å«ç»“æžœçš„ç®­å¤´è¡¨ã€‚
        """
        if self.table is None:
            raise ValueError("Table is not created. Please create the table first.")
        if isinstance(imgs, str):
            imgs = [imgs]  # å¦‚æžœæ˜¯å•ä¸ªå­—ç¬¦ä¸²ï¼Œå°†å…¶è½¬æ¢ä¸ºåˆ—è¡¨
        assert isinstance(imgs, list), f"img must be a string or a list of strings. Got {type(imgs)}"
        embeds = self.model.embed(imgs)  # èŽ·å–å›¾åƒçš„åµŒå…¥å‘é‡
        embeds = torch.mean(torch.stack(embeds), 0).cpu().numpy() if len(embeds) > 1 else embeds[0].cpu().numpy()  # å¦‚æžœæœ‰å¤šä¸ªå›¾åƒï¼Œå–å¹³å‡å€¼
        return self.table.search(embeds).limit(limit).to_arrow()  # æŸ¥è¯¢ç›¸ä¼¼å›¾åƒå¹¶è¿”å›žç»“æžœ

    def similarity_index(self, max_dist: float = 0.2, top_k: float = None, force: bool = False) -> DataFrame:
        """
        è®¡ç®—è¡¨ä¸­æ‰€æœ‰å›¾åƒçš„ç›¸ä¼¼æ€§ç´¢å¼•ã€‚
        å‚æ•°:
            max_dist (float): è€ƒè™‘çš„æœ€å¤§L2è·ç¦»ã€‚é»˜è®¤ä¸º0.2ã€‚
            top_k (float): è€ƒè™‘çš„æœ€è¿‘æ•°æ®ç‚¹çš„ç™¾åˆ†æ¯”ã€‚é»˜è®¤ä¸ºNoneã€‚
            force (bool): æ˜¯å¦è¦†ç›–çŽ°æœ‰ç›¸ä¼¼æ€§ç´¢å¼•ã€‚é»˜è®¤ä¸ºTrueã€‚
        è¿”å›ž:
            (pandas.DataFrame): åŒ…å«ç›¸ä¼¼æ€§ç´¢å¼•çš„æ•°æ®æ¡†ã€‚
        """
        if self.table is None:
            raise ValueError("Table is not created. Please create the table first.")
        sim_idx_table_name = f"{self.sim_idx_base_name}_thres_{max_dist}_top_{top_k}".lower()  # ç”Ÿæˆç›¸ä¼¼æ€§ç´¢å¼•è¡¨å
        if sim_idx_table_name in self.connection.table_names() and not force:
            LOGGER.info("Similarity matrix already exists. Reusing it. Pass force=True to overwrite it.")
            return self.connection.open_table(sim_idx_table_name).to_pandas()  # å¦‚æžœè¡¨å·²å­˜åœ¨ï¼Œç›´æŽ¥è¿”å›ž

        if top_k and not (1.0 >= top_k >= 0.0):
            raise ValueError(f"top_k must be between 0.0 and 1.0. Got {top_k}")
        if max_dist < 0.0:
            raise ValueError(f"max_dist must be greater than 0. Got {max_dist}")

        top_k = int(top_k * len(self.table)) if top_k else len(self.table)  # è®¡ç®—top_kçš„å®žé™…å€¼
        top_k = max(top_k, 1)  # ç¡®ä¿top_kè‡³å°‘ä¸º1
        features = self.table.to_lance().to_table(columns=["vector", "im_file"]).to_pydict()  # èŽ·å–ç‰¹å¾
        im_files = features["im_file"]
        embeddings = features["vector"]

        sim_table = self.connection.create_table(sim_idx_table_name, schema=get_sim_index_schema(), mode="overwrite")  # åˆ›å»ºç›¸ä¼¼æ€§ç´¢å¼•è¡¨

        def _yield_sim_idx():
            """ç”ŸæˆåŒ…å«ç›¸ä¼¼æ€§ç´¢å¼•å’Œè·ç¦»çš„æ•°æ®æ¡†ã€‚"""
            for i in tqdm(range(len(embeddings))):
                sim_idx = self.table.search(embeddings[i]).limit(top_k).to_pandas().query(f"_distance <= {max_dist}")  # æŸ¥è¯¢ç›¸ä¼¼å›¾åƒ
                yield [
                    {
                        "idx": i,
                        "im_file": im_files[i],
                        "count": len(sim_idx),
                        "sim_im_files": sim_idx["im_file"].tolist(),
                    }
                ]

        sim_table.add(_yield_sim_idx())  # å°†ç›¸ä¼¼æ€§ç´¢å¼•æ·»åŠ åˆ°è¡¨ä¸­
        self.sim_index = sim_table  # ä¿å­˜ç›¸ä¼¼æ€§ç´¢å¼•çš„å¼•ç”¨
        return sim_table.to_pandas()  # è¿”å›žç›¸ä¼¼æ€§ç´¢å¼•çš„æ•°æ®æ¡†
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è§£é‡Šï¼š
1. **Explorerç±»**ï¼šç”¨äºŽå¤„ç†å›¾åƒæ•°æ®é›†çš„æŸ¥è¯¢å’Œç›¸ä¼¼æ€§è®¡ç®—ã€‚
2. **æž„é€ å‡½æ•°**ï¼šåˆå§‹åŒ–æ•°æ®åº“è¿žæŽ¥ã€æ¨¡åž‹å’Œæ•°æ®é›†è·¯å¾„ã€‚
3. **create_embeddings_tableæ–¹æ³•**ï¼šåˆ›å»ºåŒ…å«å›¾åƒåµŒå…¥çš„æ•°æ®åº“è¡¨ï¼Œæ”¯æŒè¦†ç›–çŽ°æœ‰è¡¨ã€‚
4. **queryæ–¹æ³•**ï¼šæ ¹æ®è¾“å…¥å›¾åƒæŸ¥è¯¢ç›¸ä¼¼å›¾åƒï¼Œè¿”å›žç»“æžœè¡¨ã€‚
5. **similarity_indexæ–¹æ³•**ï¼šè®¡ç®—å›¾åƒçš„ç›¸ä¼¼æ€§ç´¢å¼•ï¼Œè¿”å›žåŒ…å«ç›¸ä¼¼å›¾åƒå’Œè·ç¦»çš„æ•°æ®æ¡†ã€‚

è¿™äº›éƒ¨åˆ†æ˜¯å®žçŽ°å›¾åƒç›¸ä¼¼æ€§æŸ¥è¯¢å’Œå¤„ç†çš„æ ¸å¿ƒé€»è¾‘ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶æ˜¯ä¸€ä¸ªç”¨äºŽå›¾åƒæ•°æ®é›†æŽ¢ç´¢å’ŒæŸ¥è¯¢çš„å·¥å…·ï¼Œä¸»è¦ç”¨äºŽå¤„ç†YOLOï¼ˆYou Only Look Onceï¼‰æ¨¡åž‹çš„å›¾åƒæ•°æ®ã€‚æ–‡ä»¶ä¸­å®šä¹‰äº†ä¸¤ä¸ªä¸»è¦çš„ç±»ï¼š`ExplorerDataset`å’Œ`Explorer`ï¼Œå®ƒä»¬æä¾›äº†åŠ è½½å›¾åƒã€åˆ›å»ºåµŒå…¥è¡¨ã€æŸ¥è¯¢ç›¸ä¼¼å›¾åƒã€æ‰§è¡ŒSQLæŸ¥è¯¢ç­‰åŠŸèƒ½ã€‚

`ExplorerDataset`ç±»ç»§æ‰¿è‡ª`YOLODataset`ï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯åŠ è½½å›¾åƒå¹¶æž„å»ºå›¾åƒè½¬æ¢ã€‚`load_image`æ–¹æ³•æ ¹æ®ç´¢å¼•åŠ è½½å›¾åƒï¼Œå¦‚æžœå›¾åƒæœªç¼“å­˜ï¼Œåˆ™ä»Žæ–‡ä»¶ä¸­è¯»å–æˆ–åŠ è½½numpyæ•°ç»„ã€‚`build_transforms`æ–¹æ³•åˆ™åˆ›å»ºç”¨äºŽæ•°æ®é›†å›¾åƒçš„è½¬æ¢ï¼Œä¸»è¦æ˜¯æ ¼å¼åŒ–å’Œå½’ä¸€åŒ–æ“ä½œã€‚

`Explorer`ç±»æ˜¯æ ¸å¿ƒç±»ï¼Œè´Ÿè´£ä¸ŽLanceDBæ•°æ®åº“çš„è¿žæŽ¥å’Œäº¤äº’ã€‚å®ƒçš„æž„é€ å‡½æ•°æŽ¥å—æ•°æ®é›†è·¯å¾„ã€æ¨¡åž‹è·¯å¾„å’Œæ•°æ®åº“URIç­‰å‚æ•°ï¼Œå¹¶æ£€æŸ¥æ‰€éœ€çš„åº“æ˜¯å¦å®‰è£…ã€‚`create_embeddings_table`æ–¹æ³•ç”¨äºŽåˆ›å»ºä¸€ä¸ªåŒ…å«å›¾åƒåµŒå…¥çš„æ•°æ®åº“è¡¨ï¼Œå¦‚æžœè¡¨å·²å­˜åœ¨ï¼Œå¯ä»¥é€‰æ‹©è¦†ç›–ã€‚å®ƒä¼šæ£€æŸ¥æ•°æ®é›†çš„æœ‰æ•ˆæ€§ï¼Œå¹¶ç”ŸæˆåµŒå…¥å‘é‡ã€‚

åœ¨æŸ¥è¯¢åŠŸèƒ½æ–¹é¢ï¼Œ`query`æ–¹æ³•å…è®¸ç”¨æˆ·é€šè¿‡æä¾›å›¾åƒè·¯å¾„æˆ–å›¾åƒæ•°ç»„æ¥æŸ¥è¯¢ç›¸ä¼¼å›¾åƒï¼Œå¹¶è¿”å›žç»“æžœã€‚`sql_query`æ–¹æ³•åˆ™å…è®¸ç”¨æˆ·æ‰§è¡ŒSQLæ ·å¼çš„æŸ¥è¯¢ï¼Œæ”¯æŒä»Žæ•°æ®åº“ä¸­èŽ·å–ç‰¹å®šæ¡ä»¶ä¸‹çš„å›¾åƒæ•°æ®ã€‚`plot_sql_query`æ–¹æ³•å¯ä»¥å°†SQLæŸ¥è¯¢çš„ç»“æžœå¯è§†åŒ–ã€‚

æ­¤å¤–ï¼Œ`get_similar`å’Œ`plot_similar`æ–¹æ³•ç”¨äºŽèŽ·å–å’Œå¯è§†åŒ–ä¸Žç»™å®šå›¾åƒç›¸ä¼¼çš„å›¾åƒã€‚`similarity_index`æ–¹æ³•è®¡ç®—æ‰€æœ‰å›¾åƒçš„ç›¸ä¼¼æ€§ç´¢å¼•ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªåŒ…å«ç›¸ä¼¼å›¾åƒåŠå…¶è·ç¦»çš„DataFrameã€‚`plot_similarity_index`æ–¹æ³•åˆ™å¯è§†åŒ–ç›¸ä¼¼æ€§ç´¢å¼•çš„ç»“æžœã€‚

è¯¥ç±»è¿˜æä¾›äº†`ask_ai`æ–¹æ³•ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡è‡ªç„¶è¯­è¨€æŸ¥è¯¢æ¥èŽ·å–å›¾åƒæ•°æ®ï¼Œç¨‹åºä¼šå°†è‡ªç„¶è¯­è¨€è½¬æ¢ä¸ºSQLæŸ¥è¯¢å¹¶æ‰§è¡Œã€‚æœ€åŽï¼Œ`visualize`å’Œ`generate_report`æ–¹æ³•æ˜¯å ä½ç¬¦ï¼Œæœªæ¥å¯ä»¥æ‰©å±•ç”¨äºŽç»“æžœå¯è§†åŒ–å’Œæ•°æ®é›†æŠ¥å‘Šç”Ÿæˆã€‚

æ•´ä½“æ¥çœ‹ï¼Œè¿™ä¸ªç¨‹åºæ–‡ä»¶æä¾›äº†ä¸€å¥—å®Œæ•´çš„å·¥å…·ï¼Œä¾¿äºŽç”¨æˆ·å¯¹å›¾åƒæ•°æ®é›†è¿›è¡Œæ·±å…¥æŽ¢ç´¢ã€æŸ¥è¯¢å’Œå¯è§†åŒ–ï¼Œç‰¹åˆ«é€‚åˆä¸ŽYOLOæ¨¡åž‹ç»“åˆä½¿ç”¨ã€‚

### 12.ç³»ç»Ÿæ•´ä½“ç»“æž„ï¼ˆèŠ‚é€‰ï¼‰

### æ•´ä½“åŠŸèƒ½å’Œæž„æž¶æ¦‚æ‹¬

è¯¥é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäºŽYOLOv8æ¡†æž¶çš„ç›®æ ‡æ£€æµ‹å’Œå›¾åƒåˆ†å‰²å·¥å…·ï¼Œæä¾›äº†ä¸€ç³»åˆ—æ¨¡å—å’ŒåŠŸèƒ½ï¼Œæ—¨åœ¨å®žçŽ°é«˜æ•ˆçš„æ¨¡åž‹è®­ç»ƒã€æŽ¨ç†å’Œæ•°æ®é›†æŽ¢ç´¢ã€‚é¡¹ç›®ç»“æž„åŒ…æ‹¬æ¨¡åž‹å®šä¹‰ã€è®­ç»ƒæµç¨‹ã€æ•°æ®å¤„ç†ã€ç”¨æˆ·ç•Œé¢å’Œå¯è§†åŒ–å·¥å…·ç­‰å¤šä¸ªéƒ¨åˆ†ã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š

1. **æ¨¡åž‹å®šä¹‰ä¸Žé¢„æµ‹**ï¼šå®žçŽ°äº†YOLOv8å’ŒSAMï¼ˆSegment Anything Modelï¼‰ç­‰æ¨¡åž‹çš„å®šä¹‰ä¸Žé¢„æµ‹åŠŸèƒ½ï¼Œæ”¯æŒå¤šç§è¾“å…¥æç¤ºå’Œä»»åŠ¡ç±»åž‹ã€‚
2. **è®­ç»ƒæµç¨‹**ï¼šæä¾›äº†è®­ç»ƒæ¨¡åž‹çš„å®Œæ•´æµç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®é›†æž„å»ºã€æ•°æ®åŠ è½½ã€æ¨¡åž‹è®­ç»ƒã€æŸå¤±è·Ÿè¸ªå’Œç»“æžœå¯è§†åŒ–ã€‚
3. **æ•°æ®é›†æŽ¢ç´¢**ï¼šé€šè¿‡å›¾åƒæ•°æ®é›†æŽ¢ç´¢å·¥å…·ï¼Œç”¨æˆ·å¯ä»¥æŸ¥è¯¢ã€å¯è§†åŒ–å’Œåˆ†æžæ•°æ®é›†ï¼Œæ”¯æŒä¸Žæ•°æ®åº“çš„äº¤äº’ã€‚
4. **ç”¨æˆ·ç•Œé¢**ï¼šæä¾›äº†ç®€å•çš„ç”¨æˆ·ç•Œé¢æ¥è¿è¡Œå’Œç®¡ç†æ¨¡åž‹è®­ç»ƒå’ŒæŽ¨ç†ä»»åŠ¡ã€‚
5. **å·¥å…·ä¸Žå®žç”¨åŠŸèƒ½**ï¼šåŒ…æ‹¬å›žè°ƒå‡½æ•°ã€æ•°æ®è½¬æ¢ã€æ¨¡åž‹æŽ¨ç†ç­‰å®žç”¨å·¥å…·ï¼Œå¢žå¼ºäº†é¡¹ç›®çš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ã€‚

### æ–‡ä»¶åŠŸèƒ½æ•´ç†è¡¨

| æ–‡ä»¶è·¯å¾„                                                                 | åŠŸèƒ½æè¿°                                                     |
|------------------------------------------------------------------------|------------------------------------------------------------|
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéžå¿…è¦ï¼‰\ultralytics\models\fastsam\predict.py` | å®žçŽ°å¿«é€ŸSAMåˆ†å‰²æ¨¡åž‹çš„é¢„æµ‹åŠŸèƒ½ï¼Œå¤„ç†å›¾åƒåˆ†å‰²ä»»åŠ¡ã€‚                 |
| `ui.py`                                                               | æä¾›ä¸€ä¸ªæŽ¥å£æ¥è¿è¡ŒStreamlitåº”ç”¨è„šæœ¬ï¼Œå¤„ç†æ¨¡åž‹çš„å¯è§†åŒ–å’Œäº¤äº’ã€‚       |
| `code\ultralytics\models\sam\modules\__init__.py`                    | æ ‡è¯†ä¸ºPythonåŒ…ï¼Œå¯èƒ½åŒ…å«æ¨¡å—çš„åˆå§‹åŒ–ä»£ç å’Œå…¬å…±æŽ¥å£ã€‚               |
| `code\ultralytics\models\sam\model.py`                               | å®šä¹‰SAMæ¨¡åž‹ç±»ï¼Œæä¾›æ¨¡åž‹åŠ è½½ã€é¢„æµ‹å’Œä¿¡æ¯è®°å½•åŠŸèƒ½ã€‚                 |
| `train.py`                                                            | å¤„ç†YOLOæ¨¡åž‹çš„è®­ç»ƒæµç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®é›†æž„å»ºã€æ•°æ®åŠ è½½å’ŒæŸå¤±è·Ÿè¸ªã€‚       |
| `code\ultralytics\data\explorer\explorer.py`                        | æä¾›å›¾åƒæ•°æ®é›†æŽ¢ç´¢å’ŒæŸ¥è¯¢å·¥å…·ï¼Œæ”¯æŒç›¸ä¼¼å›¾åƒæŸ¥è¯¢å’ŒSQLæŸ¥è¯¢ã€‚         |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéžå¿…è¦ï¼‰\ultralytics\models\sam\model.py` | å¦ä¸€ä¸ªSAMæ¨¡åž‹çš„å®žçŽ°ï¼Œå¯èƒ½ä¸Žä¹‹å‰çš„æ¨¡åž‹å®žçŽ°æœ‰æ‰€ä¸åŒã€‚               |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéžå¿…è¦ï¼‰\ultralytics\models\fastsam\__init__.py` | åˆå§‹åŒ–fastsamæ¨¡å—ï¼Œç¡®ä¿æ¨¡å—çš„å¯ç”¨æ€§ã€‚                           |
| `code\ultralytics\utils\callbacks\mlflow.py`                         | æä¾›ä¸ŽMLflowé›†æˆçš„å›žè°ƒå‡½æ•°ï¼Œç”¨äºŽè·Ÿè¸ªå’Œè®°å½•è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŒ‡æ ‡ã€‚       |
| `code\ultralytics\nn\modules\transformer.py`                         | å®žçŽ°Transformeræ¨¡å—ï¼Œå¯èƒ½ç”¨äºŽæ¨¡åž‹çš„ç‰¹å¾æå–æˆ–å¤„ç†ã€‚               |
| `code\ultralytics\utils\triton.py`                                   | æä¾›ä¸ŽTritonæŽ¨ç†æœåŠ¡å™¨çš„é›†æˆï¼Œæ”¯æŒæ¨¡åž‹çš„åœ¨çº¿æŽ¨ç†ã€‚                |
| `code\ultralytics\models\yolo\segment\train.py`                     | å¤„ç†YOLOæ¨¡åž‹çš„åˆ†å‰²ä»»åŠ¡è®­ç»ƒæµç¨‹ã€‚                               |
| `code\ultralytics\data\__init__.py`                                  | åˆå§‹åŒ–æ•°æ®æ¨¡å—ï¼Œå¯èƒ½åŒ…å«æ•°æ®åŠ è½½å’Œå¤„ç†çš„å…¬å…±æŽ¥å£ã€‚               |

ä»¥ä¸Šè¡¨æ ¼æ€»ç»“äº†æ¯ä¸ªæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½ï¼Œå±•ç¤ºäº†é¡¹ç›®çš„æ•´ä½“ç»“æž„å’ŒåŠŸèƒ½æ¨¡å—ã€‚

æ³¨æ„ï¼šç”±äºŽæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰â€ä¸­éƒ¨åˆ†ä»£ç å¯èƒ½ä¼šä¼˜åŒ–å‡çº§ï¼Œä»…ä¾›å‚è€ƒå­¦ä¹ ï¼Œå®Œæ•´â€œè®­ç»ƒæºç â€ã€â€œWebå‰ç«¯ç•Œé¢â€å’Œâ€œ70+ç§åˆ›æ–°ç‚¹æºç â€ä»¥â€œ13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†èŽ·å–â€çš„å†…å®¹ä¸ºå‡†ã€‚

### 13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†èŽ·å–

![19.png](19.png)


# [ä¸‹è½½é“¾æŽ¥ï¼šhttps://mbd.pub/o/bread/ZpuXlplu](https://mbd.pub/o/bread/ZpuXlplu)